{"version":3,"file":"smf.player.js","mappings":"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KAAK,CAACjI,OAAN,GAAgB0F,KAAK,CAAC,CAAD,CAArB;AACAqE,UAAAA,UAAU,GAAG,IAAI7D,UAAJ,CAAe,CAC1B,OAAO+B,KAAK,CAACvL,OADa,EAE1BuL,KAAK,CAAC7H,UAFoB,EAG1B6H,KAAK,CAAC5H,UAHoB,CAAf,CAAb;AAKD;;AACD6J,QAAAA,UAAU,CAACxP,IAAX,CAAgBqP,UAAhB,EAzQgB,CA2QhB;;AACAE,QAAAA,UAAU,CAACvP,IAAX,CAAgBuN,KAAhB;AACD;;AAED,WAAKnN,MAAL,CAAYJ,IAAZ,CAAiBuP,UAAjB;AACA,WAAK1F,WAAL,CAAiB7J,IAAjB,CAAsBwP,UAAtB;AACD;;;;;;;;;;;;;;;;AClaH,QAAQ,iBAAiB;;AAEzB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAY,aAAa;AACzB;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAM,GAAG,IAAI,QAAQ,MAAM,KAAK,GAAG,OAAO;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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","sources":["webpack://SMF/webpack/universalModuleDefinition","webpack://SMF/./src/3mle.js","webpack://SMF/./src/PSGConverter.js","webpack://SMF/./src/meta.js","webpack://SMF/./src/midi_event.js","webpack://SMF/./src/mld.js","webpack://SMF/./src/mmi.js","webpack://SMF/./src/mms.js","webpack://SMF/./src/ms2mml.js","webpack://SMF/./src/riff.js","webpack://SMF/./src/smf.js","webpack://SMF/./node_modules/ini/ini.js","webpack://SMF/webpack/bootstrap","webpack://SMF/webpack/runtime/compat get default export","webpack://SMF/webpack/runtime/define property getters","webpack://SMF/webpack/runtime/hasOwnProperty shorthand","webpack://SMF/webpack/runtime/make namespace object","webpack://SMF/./src/player.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"SMF\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SMF\"] = factory();\n\telse\n\t\troot[\"SMF\"] = factory();\n})((typeof self !== 'undefined' ? self : this), function() {\nreturn ","import PSGConverter from './PSGConverter';\nimport { MetaEvent, ChannelEvent, SystemExclusiveEvent } from './midi_event';\nimport MakiMabiSequence from './mms';\n/**\n * @classdesc   Three Macro Language Editor (3MLE) mml file Parser\n *\n * @author      Logue <logue@hotmail.co.jp>\n * @copyright   2019 Masashi Yoshikawa <https://logue.dev/> All rights reserved.\n * @license     MIT\n */\nexport default class ThreeMacroLanguageEditor extends MakiMabiSequence {\n  /**\n   * @param {ByteArray} input\n   * @param {Object=} optParams\n   */\n  constructor(input, optParams = {}) {\n    super(input, optParams);\n  }\n  /**\n   */\n  parse() {\n    this.parseHeader();\n    this.parseTracks();\n    this.toPlainTrack();\n  }\n  /**\n   */\n  parseHeader() {\n    const header = this.input.Settings;\n    /** @type {TextEncoder} */\n    this.encoder = new TextEncoder(header.Encoding || 'shift_jis');\n    /** @param {string} */\n    this.title = header.Title;\n    /** @param {string} */\n    this.author = header.Source;\n    /** @param {number} */\n    this.timeDivision = header.TimeBase | 0 || 32;\n\n    // 曲名と著者情報を付加\n    /** @type {array}  */\n    const headerTrack = [];\n    // GM Reset\n    headerTrack.push(\n      new SystemExclusiveEvent(\n        'SystemExclusive',\n        0,\n        0,\n        [0x7e, 0x7f, 0x09, 0x01]\n      )\n    );\n    headerTrack.push(new MetaEvent('SequenceTrackName', 0, 0, [this.title]));\n    headerTrack.push(new MetaEvent('CopyrightNotice', 0, 0, [this.author]));\n    headerTrack.push(new MetaEvent('TextEvent', 0, 0, [header.Memo]));\n    headerTrack.push(\n      new MetaEvent('TimeSignature', 0, 0, [\n        header.TimeSignatureNN | 0 || 4,\n        header.TimeSignatureDD | 0 || 4,\n        0,\n        0,\n      ])\n    );\n    headerTrack.push(new MetaEvent('EndOfTrack', 0, 0));\n    this.tracks.push(headerTrack);\n\n    // 3MLE EXTENSION、Settingsを取り除く\n    delete this.input['3MLE EXTENSION'];\n    delete this.input.Settings;\n  }\n\n  /**\n   * MML parse\n   */\n  parseTracks() {\n    const input = this.input;\n    /** @type {array} 終了時間比較用 */\n    const endTimes = [];\n\n    /** @type {array} 各ブロックのMML */\n    const mmls = [];\n    /** @type {array} 各ブロックの演奏情報 */\n    const settings = [];\n\n    for (const block in this.input) {\n      if (!Object.prototype.hasOwnProperty.call(this.input, block)) {\n        continue;\n      }\n      if (block.match(/^Channel(\\d+)$/i)) {\n        // MMLは[Channel[n]]ブロックのキー\n\n        // ひどいファイル形式だ・・・。\n        mmls[(RegExp.$1 | 0) - 1] = Object.keys(input[block])\n          .join('')\n          .replace(/\\/\\*([^*]|\\*[^/])*\\*\\//g, '');\n      }\n\n      if (block.match(/^ChannelProperty(\\d+)$/i)) {\n        // 各パートの楽器情報などは[ChannelProperty[n]]に格納されている\n        settings[(RegExp.$1 | 0) - 1] = {\n          name: input[block].Name,\n          instrument: input[block].Patch | 0,\n          panpot: input[block].Pan | 0,\n        };\n      }\n    }\n\n    /** @type {array} 整形済みデータ */\n    const data = [];\n\n    // データを整形\n    for (const no in mmls) {\n      if (!Object.prototype.hasOwnProperty.call(mmls, no)) {\n        continue;\n      }\n      if (settings[no] !== void 0) {\n        data[no] = {\n          mml: mmls[no],\n          name: settings[no].name || '',\n          instrument: settings[no].instrument || 0,\n          panpot: settings[no].panpot || 64,\n        };\n      } else {\n        data[no] = {\n          mml: mmls[no],\n          name: '',\n          instrument: 0,\n          panpot: 64,\n        };\n      }\n    }\n\n    // console.log(data);\n\n    for (const part in data) {\n      if (!Object.prototype.hasOwnProperty.call(data, part)) {\n        continue;\n      }\n      /** @type {number} */\n      const ch = part | 0;\n      /** @type {array} MIDIイベント */\n      let track = [];\n      if (data[part].mml === '') {\n        // 空っぽのMMLトラックの場合処理しない\n        return;\n      }\n\n      // 楽器名\n      track.push(new MetaEvent('InsturumentName', 0, 48, [data[part].name]));\n      // プログラムチェンジ\n      track.push(\n        new ChannelEvent('ProgramChange', 0, 96, ch, data[part].instrument)\n      );\n      // パン\n      track.push(\n        new ChannelEvent('ControlChange', 0, 154, ch, 10, data[part].panpot)\n      );\n\n      /** @param {PSGConverter} */\n      const mml2Midi = new PSGConverter({\n        timeDivision: this.timeDivision,\n        channel: ch,\n        timeOffset: 386,\n        mml: data[part].mml,\n      });\n      // トラックにマージ\n      track = track.concat(mml2Midi.events);\n      // 演奏時間を更新\n      endTimes.push(mml2Midi.endTime);\n\n      // トラック終了\n      track.concat(new MetaEvent('EndOfTrack', 0, Math.max(endTimes)));\n      this.tracks.push(track);\n    }\n\n    this.numberOfTracks = this.tracks.length;\n  }\n}\n","import { ChannelEvent, MetaEvent } from './midi_event';\n/**\n * @class       PSGConverter\n * @classdesc   Mabinogi MML and Maple Story 2 MML to MIDI Converter.\n * @version     3.0.3\n *\n * @author      Logue <logue@hotmail.co.jp>\n * @copyright   2019-2021 Masashi Yoshikawa <https://logue.dev/> All rights reserved.\n * @license     MIT\n */\nexport default class PSGConverter {\n  /**\n   * Constructor\n   * @param {array} optParams\n   */\n  constructor(optParams = {}) {\n    /** @type {number} 分解能 */\n    this.timeDivision = optParams.timeDivision | 0 || 96;\n    /** @type {number} チャンネル（0～15） */\n    this.channel = optParams.channel | 0;\n    /** @type {number} 演奏開始までのオフセット時間 */\n    this.timeOffset = optParams.timeOffset | 0;\n    /** @type {string} MMLのチャンネルごとのマッチパターン */\n    this.PATTERN = /[a-glnortv<>][+#-]?\\d*\\.?&?/g;\n    /** @type {Array<string, number>} ノートのマッチングテーブル */\n    this.NOTE_TABLE = {\n      c: 0,\n      d: 2,\n      e: 4,\n      f: 5,\n      g: 7,\n      a: 9,\n      b: 11,\n    };\n    /** @type {number} １拍（Tick連動） */\n    this.MINIM = this.timeDivision * 2;\n    /** @type {number} 1小節 */\n    this.SEMIBREVE = this.timeDivision * 4;\n    /** @type {number} ベロシティの倍率 */\n    this.VELOCITY_MAGNIFICATION = 7; // 127÷15≒8.4\n    /** @type {array} MMLデータ */\n    this.mml = optParams.mml;\n    /** @type {array} イベント */\n    this.events = [];\n    /** @type {array} WML送信用イベント */\n    this.plainEvents = [];\n    /** @type {number} 終了時間 */\n    this.endTime = 0;\n    /** @type {number} ノートオフの逆オフセット(tick指定) */\n    this.noteOffNegativeOffset = 2;\n    /** @type {bool} テンポ命令を無視する */\n    this.ignoreTempo = optParams.igonreTempo | false;\n    /** @type {number} 最大オクターブ */\n    this.maxOctave = optParams.maxOctave | 8;\n    /** @type {number} 最小オクターブ */\n    this.minOctave = optParams.minOctave | 0;\n    /** @type {number} オクターブモード（0：処理しない。1：外れる音階はその前後のオクターブをループする。2：常に同じ音を鳴らす */\n    this.octaveMode = optParams.octaveMode | 0;\n    /** @type {number} 最低音階（octaveModeが0の場合は無視されます。デフォルトはピアノの音階。GM音源で再生するとき用） */\n    this.minNote = optParams.minNote | 12;\n    /** @type {number} 最高音階（octaveModeが0の場合は無視されます。デフォルトはピアノの音階。GM音源で再生するとき用） */\n    this.maxNote = optParams.minNote | 98;\n    // 変換実行\n    this.parse();\n  }\n\n  /**\n   * Parse MML\n   */\n  parse() {\n    /** @type {Array} MMLストリーム */\n    let mmls = [];\n    try {\n      // 小文字に変換した後正規表現で命令単位で分割する。\n      mmls = this.mml.toLowerCase().match(this.PATTERN);\n    } catch (e) {\n      console.warn('Could not parse MML.', this.mml);\n      return;\n    }\n\n    if (!mmls) {\n      // 空欄の場合処理しない\n      return;\n    }\n\n    /** @type {number} タイムスタンプ */\n    let time = this.timeOffset;\n    /** @type {number} 現在の音の長さ */\n    let currentSoundLength = this.timeDivision;\n    /** @type {number} 現在の音階 */\n    let currentNote = 0;\n    /** @type {number} ベロシティ(0～15) */\n    let currentVelocity = 8;\n    /** @type {number} オクターブ(0~8) */\n    let currentOctave = 4;\n    /** @type {bool} タイ記号 */\n    let tieEnabled = false;\n\n    /** @type {array} MIDIイベント */\n    const events = [];\n\n    // MMLを命令単位でパース\n    for (const message of mmls) {\n      /** @type {number} すすめるtick数 */\n      let tick = currentSoundLength | 0;\n      /** @type {string} コマンド */\n      let command = '';\n      /** @type {number} 値 */\n      let value = 0;\n\n      // 音長(L)、オクターブ(O<>)、テンポ（T）、ベロシティ（V）をパース\n      if (message.match(/([lotv<>])([1-9]\\d*|0?)(\\.?)(&?)/)) {\n        command = RegExp.$1.toLowerCase();\n        value = RegExp.$2 | 0;\n\n        if (tieEnabled && RegExp.$4 !== '&') {\n          // タイ記号\n          tieEnabled = false;\n          events.push(\n            new ChannelEvent(\n              'NoteOff',\n              0,\n              time - this.noteOffNegativeOffset,\n              this.channel,\n              currentNote\n            )\n          );\n        }\n\n        switch (command) {\n          case 'l':\n            // 音長設定 Ln[.] (n=1～192)\n            if (value >= 1 && value <= this.MINIM) {\n              currentSoundLength = Math.floor(this.SEMIBREVE / value);\n              if (RegExp.$3 === '.') {\n                // 付点の場合音長を1.5倍する\n                currentSoundLength = Math.floor(currentSoundLength * 1.5);\n              }\n            }\n            break;\n          case 'o':\n            // オクターブ設定 On (n=1～8)\n            if (value >= this.minOctave && value <= this.maxOctave) {\n              currentOctave = value;\n            }\n            break;\n          case 't':\n            // テンポ設定 Tn (n=32～255)\n            events.push(\n              new MetaEvent('SetTempo', 0, time, [Math.floor(60000000 / value)])\n            );\n            break;\n          case 'v':\n            // ベロシティ調整\n            if (value >= 0 && value <= 15) {\n              currentVelocity = value;\n            }\n            break;\n\n          // 簡易オクターブ設定 {<>}\n          case '<':\n            currentOctave =\n              currentOctave <= this.minOctave\n                ? this.minOctave\n                : currentOctave - 1;\n            break;\n          case '>':\n            currentOctave =\n              currentOctave >= this.maxOctave\n                ? this.maxOctave\n                : currentOctave + 1;\n            break;\n        }\n      } else if (message.match(/([a-gn])([+#-]?)(\\d*)(\\.?)(&?)/)) {\n        // ノート命令（CDEFGAB）、絶対音階指定（N）をパース\n\n        /** @type {number} 音階 */\n        let note = 0;\n        command = RegExp.$1.toLowerCase();\n        value = RegExp.$3 | 0;\n\n        if (command === 'n') {\n          // Nn：絶対音階指定 Lで指定した長さに設定\n          note = value;\n        } else {\n          // [A-G]：音名表記\n          // 音符の長さ指定: n分音符→128分音符×tick数\n          if (value >= 1 && value <= this.MINIM) {\n            tick = Math.floor(this.SEMIBREVE / value); // L1 -> 384tick .. L64 -> 6tick\n          }\n          if (RegExp.$4 === '.') {\n            tick = Math.floor(tick * 1.5); // 付点つき -> 1.5倍\n          }\n\n          if (this.octaveMode !== 2) {\n            // 音名→音階番号変換(C1 -> 12, C4 -> 48, ..)\n            note = 12 * currentOctave + this.NOTE_TABLE[command];\n\n            // 調音記号の処理\n            if (RegExp.$2 === '+' || RegExp.$2 === '#') {\n              note++;\n            } else if (RegExp.$2 === '-') {\n              note--;\n            }\n          }\n        }\n\n        // オクターブ調整（楽器の音域エミュレーション。通常は0。GM互換モード時のみ使用）\n        switch (this.octaveMode) {\n          case 1:\n            // オクターブループモード\n            while (note < this.minNote) note = note + 12;\n            while (note > this.maxNote) note = note - 12;\n            note += 12;\n            break;\n          case 2:\n            // ワンショットモード（音階の強制指定）\n            note = this.maxNote;\n            break;\n          default:\n            // 通常モード（非GMモードでは常にこれ）\n            note += 12;\n            break;\n        }\n\n        if (!tieEnabled) {\n          // 前回タイ記号が無いときのみノートオン\n          events.push(\n            new ChannelEvent(\n              'NoteOn',\n              0,\n              time,\n              this.channel,\n              note,\n              currentVelocity * this.VELOCITY_MAGNIFICATION // ※127÷15≒8.4なので8とする。\n            )\n          );\n        } else if (note !== currentNote) {\n          // c&dなど無効なタイの処理\n          events.push(\n            new ChannelEvent(\n              'NoteOff',\n              0,\n              time - this.noteOffNegativeOffset,\n              this.channel,\n              currentNote\n            )\n          );\n        }\n\n        // タイムカウンタを音符の長さだけ進める\n        time += tick;\n\n        // ノートオフ命令の追加\n        if (RegExp.$5 === '&') {\n          // タイ記号の処理\n          tieEnabled = true;\n          currentNote = note; // 直前の音階を保存\n        } else {\n          tieEnabled = false;\n          // 発音と消音が同じ時間の場合、そこのノートが再生されないため、消音時にtimeを-1する。\n          events.push(\n            new ChannelEvent(\n              'NoteOff',\n              0,\n              time - this.noteOffNegativeOffset,\n              this.channel,\n              note\n            )\n          );\n        }\n      } else if (message.match(/R(\\d*)(\\.?)/i)) {\n        // 休符設定 R[n][.] (n=1～64)\n        value = RegExp.$1 | 0;\n\n        if (value >= 1 && value <= this.MINIM) {\n          // L1 -> 128tick .. L64 -> 2tick\n          tick = Math.floor(this.SEMIBREVE / value);\n        }\n\n        if (RegExp.$2 === '.') {\n          // 付点つき -> 1.5倍\n          tick = Math.floor(tick * 1.5);\n        }\n\n        time += tick; // タイムカウンタを休符の長さだけ進める\n      } else {\n        console.warn('unknown signeture.', message);\n      }\n    }\n    // イベントを代入\n    this.events = events;\n    // 演奏完了時間を代入\n    this.endTime = time;\n  }\n}\n","// This file is auto-generated by the build system.\nconst Meta = {\n  version: '0.3.6',\n  date: '2021-11-04T11:03:20.907Z',\n};\nexport default Meta;","/**\n * Midi Event abstract Structure\n */\nclass Event {\n  /**\n   * @param {string} subtype event subtype name.\n   * @param {number} deltaTime delta time.\n   * @param {number} time time.\n   */\n  constructor(subtype, deltaTime, time) {\n    /** @type {string} */\n    this.subtype = subtype;\n    /** @type {number} */\n    this.deltaTime = deltaTime;\n    /** @type {number} */\n    this.time = time;\n  }\n}\n\n/**\n * Midi Channel Event Structure\n * @extends {Event}\n */\nclass ChannelEvent extends Event {\n  /**\n   * @param {string} subtype\n   * @param {number} deltaTime delta time.\n   * @param {number} time time.\n   * @param {number} channel\n   * @param {number=} optParameter1\n   * @param {number=} optParameter2\n   */\n  constructor(subtype, deltaTime, time, channel, optParameter1, optParameter2) {\n    super(subtype, deltaTime, time);\n    /** @type {number} */\n    this.channel = channel;\n    /** @type {(number|undefined)} */\n    this.parameter1 = optParameter1;\n    /** @type {(number|undefined)} */\n    this.parameter2 = optParameter2;\n  }\n}\n\n/**\n * System Exclusive Event Structure\n * @extends {Event}\n */\nclass SystemExclusiveEvent extends Event {\n  /**\n   * @param {string} subtype\n   * @param {number} deltaTime delta time.\n   * @param {number} time time.\n   * @param {ByteArray} data\n   */\n  constructor(subtype, deltaTime, time, data) {\n    super(subtype, deltaTime, time);\n    /** @type {ByteArray} */\n    this.data = data;\n  }\n}\n\n/**\n * Midi Meta Event Structure\n * @extends {Event}\n */\nclass MetaEvent extends Event {\n  /**\n   * @param {string} subtype\n   * @param {number} deltaTime delta time.\n   * @param {number} time time.\n   * @param {Array.<*>} data meta data.\n   */\n  constructor(subtype, deltaTime, time, data) {\n    super(subtype, deltaTime, time);\n    /** @type {Array.<*>} */\n    this.data = data;\n  };\n}\n\nexport {\n  ChannelEvent,\n  SystemExclusiveEvent,\n  MetaEvent,\n};\n","/**\n * Mld Parser Class\n */\nexport default class Mld {\n  /**\n   * @param {ByteArray} input\n   * @param {Object=} optParams\n   */\n  constructor(input, optParams = {}) {\n    /** @type {ByteArray} */\n    this.input = input;\n    /** @type {number} */\n    this.ip = optParams.index || 0;\n    /** @type {number} */\n    this.timeDivision = optParams.timeDivision || 48;\n    /** @type {Object} */\n    this.header = {};\n    /** @type {Object} */\n    this.dataInformation = {};\n    /** @type {Array.<Array.<Object>>} */\n    this.tracks = [];\n  }\n\n  /**\n   */\n  parse() {\n    this.parseHeader();\n    this.parseDataInformation();\n    this.parseTracks();\n  }\n\n  /**\n   */\n  parseHeader() {\n    /** @type {ByteArray} */\n    const input = this.input;\n    /** @type {number} */\n    let ip = this.ip;\n    /** @type {Object} */\n    const header = (this.header = {});\n    /** @type {string} */\n    const signature = String.fromCharCode(\n      input[ip++],\n      input[ip++],\n      input[ip++],\n      input[ip++]\n    );\n\n    if (signature !== 'melo') {\n      throw new Error('invalid MFi signature:' + signature);\n    }\n\n    header.fileLength =\n      ((input[ip++] << 24) |\n        (input[ip++] << 16) |\n        (input[ip++] << 8) |\n        input[ip++]) >>>\n      0;\n\n    header.trackOffset = ((input[ip++] << 16) | input[ip++]) + ip;\n\n    header.dataMajorType = input[ip++];\n    header.dataMinorType = input[ip++];\n    header.numberOfTracks = input[ip++];\n\n    this.ip = ip;\n  }\n\n  /**\n   */\n  parseDataInformation() {\n    /** @type {ByteArray} */\n    const input = this.input;\n    /** @type {number} */\n    let ip = this.ip;\n    /** @type {Object} */\n    const dataInformation = (this.dataInformation = {\n      copy: null,\n      date: null,\n      exst: null,\n      note: null,\n      prot: null,\n      sorc: null,\n      titl: null,\n      trac: null,\n      vers: null,\n    });\n    /** @type {string} */\n    let type;\n    /** @type {number} */\n    let size;\n\n    while (ip < this.header.trackOffset) {\n      type = String.fromCharCode(\n        input[ip++],\n        input[ip++],\n        input[ip++],\n        input[ip++]\n      );\n      size = (input[ip++] << 8) | input[ip++];\n\n      switch (type) {\n        case 'titl':\n        /* FALLTHROUGH */\n        case 'copy':\n        /* FALLTHROUGH */\n        case 'vers':\n        /* FALLTHROUGH */\n        case 'date':\n        /* FALLTHROUGH */\n        case 'prot':\n          dataInformation[type] = String.fromCharCode.apply(\n            null,\n            input.subarray(ip, (ip += size))\n          );\n          break;\n        case 'sorc':\n          dataInformation[type] = input[ip++];\n          break;\n        case 'note':\n          dataInformation[type] = (input[ip++] << 8) | input[ip++];\n          break;\n        case 'exst':\n          /* FALLTHROUGH */\n          break;\n        default:\n          dataInformation[type] = input.subarray(ip, (ip += size));\n          break;\n      }\n    }\n\n    this.ip = ip;\n  }\n\n  /**\n   */\n  parseTracks() {\n    /** @type {ByteArray} */\n    const input = this.input;\n    /** @type {number} */\n    let ip = this.ip;\n    /** @type {string} */\n    let signature;\n    /** @type {number} */\n    let size;\n    /** @type {number} */\n    let limit;\n    /** @type {number} */\n    let status;\n    /** @type {number} */\n    let extendStatus;\n    /** @type {Object} */\n    let message;\n    /** @type {Array.<Array.<Object>>} */\n    const tracks = (this.tracks = []);\n    /** @type {Array.<Object>} */\n    let track;\n    /** @type {number} */\n    let i;\n    /** @type {number} */\n    let il;\n    /**\n     * @return {Array.<Object>}\n     */\n    const parseEditInstrument = () => {\n      /** @type {number} */\n      const length = (input[ip++] << 8) | input[ip++];\n      /** @type {number} */\n      const limit = ip + length;\n      /** @type {Array.<Object>} */\n      const result = [];\n      /** @type {Object} */\n      let info;\n\n      // const\n      if (input[ip++] !== 1) {\n        throw new Error('invalid EditInstrument const value:' + input[ip - 1]);\n      }\n\n      while (ip < limit) {\n        info = {};\n\n        info.part = (input[ip++] >> 4) & 0x3;\n        info.modulator = {\n          ML: input[ip] >> 5,\n          VIV: (input[ip] >> 4) & 0x1,\n          EG: (input[ip] >> 3) & 0x1,\n          SUS: (input[ip] >> 2) & 0x1,\n          RR: ((input[ip++] & 0x3) << 2) | (input[ip] >> 6),\n          DR: (input[ip] >> 4) & 0xf,\n          AR: ((input[ip++] & 0x3) << 2) | (input[ip] >> 6),\n          SL: (input[ip] >> 4) & 0xf,\n          TL: ((input[ip++] & 0x3) << 4) | (input[ip] >> 4),\n          WF: (input[ip] >> 3) & 0x1,\n          FB: input[ip++] & 0x7,\n        };\n        info.carrier = {\n          ML: input[ip] >> 5,\n          VIV: (input[ip] >> 4) & 0x1,\n          EG: (input[ip] >> 3) & 0x1,\n          SUS: (input[ip] >> 2) & 0x1,\n          RR: ((input[ip++] & 0x3) << 2) | (input[ip] >> 6),\n          DR: (input[ip] >> 4) & 0xf,\n          AR: ((input[ip++] & 0x3) << 2) | (input[ip] >> 6),\n          SL: (input[ip] >> 4) & 0xf,\n          TL: ((input[ip++] & 0x3) << 4) | (input[ip] >> 4),\n          WF: (input[ip] >> 3) & 0x1,\n          FB: input[ip++] & 0x7,\n        };\n        info.octaveSelect = input[ip++] & 0x3;\n\n        result.push(info);\n      }\n\n      return result;\n    };\n    /**\n     * @return {{part: number, switch: number}}\n     */\n    const parseVibrato = () => {\n      // const\n      if (input[ip++] !== 1) {\n        throw new Error('invalid Vibrato const value:' + input[ip - 1]);\n      }\n\n      return {\n        part: (input[ip++] >> 5) & 0x3,\n        switch: input[ip++] >> 6,\n      };\n    };\n    /**\n     * @return {{data: ByteArray}}\n     */\n    const parseDeviceSpecific = () => {\n      /** @type {number} */\n      const length = (input[ip++] << 8) | input[ip++];\n      /** @type {number} */\n      const limit = ip + length;\n\n      // const\n      if (input[ip++] !== 0x11) {\n        throw new Error('invalid DeviceSpecific const value:' + input[ip - 1]);\n      }\n\n      return {\n        data: input.subarray(ip, (ip += limit - ip)),\n      };\n    };\n\n    for (i = 0, il = this.header.numberOfTracks; i < il; ++i) {\n      signature = String.fromCharCode(\n        input[ip++],\n        input[ip++],\n        input[ip++],\n        input[ip++]\n      );\n\n      if (signature !== 'trac') {\n        throw new Error('invalid track signature:' + signature);\n      }\n\n      size =\n        (input[ip++] << 24) |\n        (input[ip++] << 16) |\n        (input[ip++] << 8) |\n        input[ip++];\n\n      limit = ip + size;\n\n      track = tracks[i] = [];\n\n      while (ip < limit) {\n        message = {\n          key: null,\n          length: null,\n          octaveShift: null,\n          subType: null,\n          type: null,\n          value: {},\n          velocity: null,\n          voice: null,\n        };\n\n        // delta time\n        message.deltaTime = input[ip++];\n\n        // status\n        status = input[ip++];\n        if (status !== 0xff) {\n          message.type = 'note';\n          message.subType = 'Note';\n          message.voice = status >> 6;\n          message.key = status & 0x3f;\n\n          // note length\n          // noteLength = message.length = input[ip++];\n\n          // extend status\n          if (this.dataInformation.note === 1) {\n            extendStatus = input[ip++];\n            message.velocity = extendStatus >> 2;\n            message.octaveShift = extendStatus & 0x3;\n          }\n        } else {\n          message.type = 'meta';\n\n          // status\n          status = input[ip++];\n          switch (status >> 4) {\n            // system message\n            case 0xb:\n              switch (status & 0xf) {\n                case 0x0:\n                  message.subType = 'MasterVolume';\n                  message.value = input[ip++];\n                  break;\n                case 0xa:\n                  message.subType = 'DrumScale';\n                  message.value = {\n                    channel: (input[ip] >> 3) & 0x7,\n                    drum: input[ip++] & 0x1,\n                  };\n                  break;\n                default:\n                  throw new Error(\n                    'unknown message type:' + status.toString(16)\n                  );\n              }\n              break;\n            // tempo message\n            case 0xc:\n              message.subType = 'SetTempo';\n              message.value = {\n                timeBase:\n                  (status & 0x7) === 7\n                    ? NaN\n                    : Math.pow(2, status & 0x7) *\n                      ((status & 0x8) === 0 ? 6 : 15),\n                tempo: input[ip++],\n              };\n              break;\n            // control message\n            case 0xd:\n              switch (status & 0xf) {\n                case 0x0:\n                  message.subType = 'Point';\n                  message.value = input[ip++];\n                  break;\n                case 0xd:\n                  message.subType = 'Loop';\n                  message.value = {\n                    id: input[ip] >> 6,\n                    count: (input[ip] >> 2) & 0xf,\n                    point: input[ip++] & 0x3,\n                  };\n                  break;\n                case 0xe:\n                  message.subType = 'Nop';\n                  message.value = input[ip++];\n                  break;\n                case 0xf:\n                  message.subType = 'EndOfTrack';\n                  message.value = input[ip++];\n                  break;\n                default:\n                  throw new Error(\n                    'unkwnon message type:' + status.toString(16)\n                  );\n              }\n              break;\n            // instrument\n            case 0xe:\n              switch (status & 0xf) {\n                case 0x0:\n                  message.subType = 'InstrumentLowPart';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    instrument: input[ip++] & 0x3f,\n                  };\n                  break;\n                case 0x1:\n                  message.subType = 'InstrumentHighPart';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    instrument: input[ip++] & 0x1,\n                  };\n                  break;\n                case 0x2:\n                  message.subType = 'Volume';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    volume: input[ip++] & 0x3f,\n                  };\n                  break;\n                case 0x3:\n                  message.subType = 'Valance';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    valance: input[ip++] & 0x3f,\n                  };\n                  break;\n                case 0x4:\n                  message.subType = 'PitchBend';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    value: input[ip++] & 0x3f,\n                  };\n                  break;\n                case 0x5:\n                  message.subType = 'ChannelAssign';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    channel: input[ip++] & 0x3f,\n                  };\n                  break;\n                case 0x6:\n                  message.subType = 'VolumeChange';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    volume: ((input[ip++] & 0x3f) << 26) >> 26,\n                  };\n                  break;\n                case 0x7:\n                  message.subType = 'PitchBendRange';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    value: input[ip++] & 0x3f,\n                  };\n                  break;\n                /*\n                case 0x8:\n                // TODO: 未遭遇\n                message.subType = 'MasterFineTuning';\n                message.value = {\n                  'part': input[ip] >> 6,\n                  'value': (input[ip++] & 0x3f)\n                };\n                break;\n                */\n                // TODO: あってるか自信ない\n                case 0x9:\n                  message.subType = 'MasterCoarseTuning';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    value: input[ip++] & 0x3f,\n                  };\n                  break;\n                case 0xa:\n                  message.subType = 'Modulation';\n                  message.value = {\n                    part: input[ip] >> 6,\n                    depth: input[ip++] & 0x3f,\n                  };\n                  break;\n                default:\n                  throw new Error(\n                    'unkwnon message type:' + status.toString(16)\n                  );\n              }\n              break;\n            // extended information\n            case 0xf:\n              switch (status & 0xf) {\n                case 0x0:\n                  message.subType = 'EditInstrument';\n                  message.value = parseEditInstrument();\n                  break;\n                case 0x1:\n                  message.subType = 'Vibrato';\n                  message.value = parseVibrato();\n                  break;\n                case 0xf:\n                  message.subType = 'DeviceSpecific';\n                  message.value = parseDeviceSpecific();\n                  break;\n                default:\n                  throw new Error(\n                    'unkwnon message type:' + status.toString(16)\n                  );\n              }\n              break;\n            default:\n              throw new Error('unkwnon message type:' + status.toString(16));\n          }\n        }\n\n        track.push(message);\n      }\n      ip = limit;\n    }\n\n    this.ip = ip;\n  }\n\n  /**\n   * @return {Object}\n   */\n  convertToMidiTracks() {\n    /** @type {Object} */\n    const result = {\n      timeDivision: this.timeDivision,\n      trac: [],\n      tracks: [],\n      plainTracks: [],\n    };\n    /** @type {Array.<Array.<Object>>} */\n    const tracks = result.tracks;\n    /** @type {Array.<Array.<Array.<number>>>} */\n    const plainTracks = result.plainTracks;\n    /** @type {Array.<Array.<Object>>} */\n    const mfiTracks = this.tracks;\n    /** @type {Array.<Object>} */\n    let mfiTrack;\n    /** @type {Object} */\n    let mfiEvent;\n    /** @type {Object} */\n    let prevEvent;\n    /** @type {Array.<Object>} */\n    let tmpTrack;\n    /** @type {number} */\n    let time;\n    /** @type {number} */\n    let pos;\n    /** @type {number} */\n    let key;\n    /** @type {number} */\n    let tmp;\n    /** @type {string} */\n    let str;\n    /** @type {number} */\n    let i;\n    /** @type {number} */\n    let il;\n    /** @type {number} */\n    let j;\n    /** @type {number} */\n    let jl;\n    /** @type {Array.<number>} */\n    const channelTime = [];\n    /** @type {number} */\n    let channel;\n\n    for (i = 0; i < 16; ++i) {\n      plainTracks[i] = [];\n      channelTime[i] = 0;\n    }\n\n    // 変換しにくい形式を平坦化する\n    for (i = 0, il = mfiTracks.length; i < il; ++i) {\n      mfiTrack = mfiTracks[i];\n      tmpTrack = [];\n\n      // note の処理\n      for (time = pos = j = 0, jl = mfiTrack.length; j < jl; ++j) {\n        mfiEvent = mfiTrack[j];\n        time += mfiEvent.deltaTime;\n        mfiEvent.id = pos;\n        mfiEvent.time = time;\n\n        switch (mfiEvent.subType) {\n          case 'Nop':\n            break;\n          case 'Note':\n            tmpTrack[pos++] = mfiEvent;\n            // TODO: value: ... 形式になおす\n            tmpTrack[pos] = {\n              id: pos,\n              type: 'internal',\n              subType: 'NoteOff',\n              time: time + mfiEvent.length,\n              key: mfiEvent.key,\n              voice: mfiEvent.voice,\n              velocity: mfiEvent.velocity,\n              octaveShift: mfiEvent.octaveShift,\n            };\n            pos++;\n            break;\n          case 'InstrumentHighPart':\n            prevEvent = mfiEvent;\n            mfiEvent = mfiTrack[++j];\n            if (mfiEvent.subType !== 'InstrumentLowPart') {\n              throw new Error('broken instrument');\n            }\n            // TODO: value: ... 形式になおす\n            tmpTrack[pos] = {\n              id: pos,\n              type: 'internal',\n              subType: 'ProgramChange',\n              time: time,\n              part: mfiEvent.value.part,\n              instrument:\n                (prevEvent.value.instrument << 6) | mfiEvent.value.instrument,\n            };\n            pos++;\n            break;\n          default:\n            tmpTrack[pos++] = mfiEvent;\n            break;\n        }\n      }\n      tmpTrack.sort((a, b) => {\n        return a.time > b.time\n          ? 1\n          : a.time < b.time\n          ? -1\n          : a.id > b.id\n          ? 1\n          : a.id < b.id\n          ? -1\n          : 0;\n      });\n\n      // MIDI トラックに作成\n      tracks[i] = [];\n      for (time = j = 0, jl = tmpTrack.length; j < jl; ++j) {\n        mfiEvent = tmpTrack[j];\n        time = mfiEvent.time;\n\n        switch (mfiEvent.subType) {\n          case 'Note':\n            // NoteOn: 9n kk vv\n            key = this.applyOctaveShift(\n              mfiEvent.key + 45,\n              mfiEvent.octaveShift\n            );\n            channel = i * 4 + mfiEvent.voice;\n\n            // TODO: リズムトラックの時は Key が -10 されているような気がする\n            if (channel === 9) {\n              key -= 10;\n            }\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0x90 | channel,\n                key,\n                mfiEvent.velocity * 2\n              )\n            );\n            break;\n          case 'NoteOff':\n            // NoteOff: 8n kk vv\n            key = this.applyOctaveShift(\n              mfiEvent.key + 45,\n              mfiEvent.octaveShift\n            );\n            channel = i * 4 + mfiEvent.voice;\n\n            // TODO: リズムトラックの時は Key が -10 されているような気がする\n            if (channel === 9) {\n              key -= 10;\n            }\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0x80 | channel,\n                key,\n                mfiEvent.velocity * 2\n              )\n            );\n            break;\n          case 'ProgramChange':\n            // Program Change: Cn pp\n            channel = i * 4 + mfiEvent.part;\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0xc0 | channel,\n                mfiEvent.instrument\n              )\n            );\n            break;\n          case 'SetTempo':\n            // SetTempo: FF 51 03 tt tt tt\n            tmp = 2880000000 / (mfiEvent.value.tempo * mfiEvent.value.timeBase);\n            channel = 0; // SetTempo は必ず先頭のトラックに配置する\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0xff,\n                0x51,\n                0x03,\n                (tmp >> 16) & 0xff,\n                (tmp >> 8) & 0xff,\n                tmp & 0xff\n              )\n            );\n            break;\n          case 'Loop':\n            // Marker: FF 06 ll ss ss ss ...\n            tmp = mfiEvent.value.count;\n            str =\n              'LOOP_' +\n              (mfiEvent.value.point === 0 ? 'START' : 'END') +\n              '=ID:' +\n              mfiEvent.value.id +\n              ',COUNT:' +\n              (tmp === 0 ? -1 : tmp);\n            channel = 0;\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                [0xff, 0x06, str.length],\n                str.split('').map((a) => {\n                  return a.charCodeAt(0);\n                })\n              )\n            );\n            break;\n          case 'MasterVolume':\n            // Master Volume: F0 7F ee 04 01 dl dm F7\n            tmp = mfiEvent.value;\n            channel = 0;\n\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0xf0,\n                0x07, // length\n                0x7f,\n                0x7f,\n                0x04,\n                0x01,\n                tmp,\n                tmp,\n                0xf7\n              )\n            );\n            break;\n          case 'Modulation':\n            // CC#1 Modulation: Bn 01 dd\n            channel = i * 4 + mfiEvent.value.part;\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0xb0 | channel,\n                0x01,\n                mfiEvent.value.depth * 2\n              )\n            );\n            break;\n          case 'Volume':\n            // CC#7 Volume: Bn 07 dd\n            channel = i * 4 + mfiEvent.value.part;\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0xb0 | channel,\n                0x07,\n                mfiEvent.value.volume * 2\n              )\n            );\n            break;\n          case 'Valance':\n            // CC#10 Panpot: Bn 0A dd\n            channel = i * 4 + mfiEvent.value.part;\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0xb0 | channel,\n                0x0a,\n                (mfiEvent.value.valance - 32) * 2 + 64\n              )\n            );\n            break;\n          case 'PitchBend':\n            // Pitch Bend: En dl dm\n            // TODO: LSB = MSB で良いか不明\n            channel = i * 4 + mfiEvent.value.part;\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0xe0 | channel,\n                mfiEvent.value.value * 2,\n                mfiEvent.value.value * 2\n              )\n            );\n            break;\n          case 'PitchBendRange':\n            // Pitch Bend: CC#100=0 CC#101=0 CC#6\n            // Bn 64 00 Bn 65 00 Bn 06 vv\n            channel = i * 4 + mfiEvent.value.part;\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0xb0 | channel,\n                0x64,\n                0x00\n              ),\n              [0x00, 0xb0 | channel, 0x65, 0x00],\n              [0x00, 0xb0 | channel, 0x06, mfiEvent.value.value * 2]\n            );\n            break;\n          case 'MasterCoarseTuning':\n            // MasterCoarseTuning: CC#100=0 CC#101=2 CC#6\n            // Bn 64 01 Bn 65 02 Bn 06 vv\n            channel = i * 4 + mfiEvent.value.part;\n            plainTracks[channel].push(\n              this.deltaTimeToByteArray(time - channelTime[channel]).concat(\n                0xb0 | channel,\n                0x64,\n                0x00\n              ),\n              [0x00, 0xb0 | channel, 0x65, 0x02],\n              [0x00, 0xb0 | channel, 0x06, mfiEvent.value.value * 2]\n            );\n            break;\n          default:\n            continue;\n        }\n\n        channelTime[channel] = mfiEvent.time;\n      }\n    }\n    return this.toSMF(plainTracks);\n  }\n\n  /**\n   * @param {number} key\n   * @param {number} octaveShift\n   * @return {number}\n   */\n  applyOctaveShift(key, octaveShift) {\n    /** @type {Array.<number>} */\n    const table = [0, 12, -24, -12];\n\n    if (table[octaveShift] !== void 0) {\n      return key + table[octaveShift];\n    }\n\n    throw new Error('invalid OctaveShift value:' + octaveShift);\n  }\n\n  /**\n   * @param {Array.<Array.<ByteArray>>} plainTracks\n   * @return {ByteArray}\n   */\n  toSMF(plainTracks) {\n    /** @type {number} @const */\n    const TimeDivision = 48;\n    /** @type {Array.<number>} */\n    let trackHeader;\n    /** @type {Array.<number>} */\n    let trackData;\n    /** @type {ByteArray} */\n    let result = [\n      0x4d,\n      0x54,\n      0x68,\n      0x64, // \"MThd\"\n      0x00,\n      0x00,\n      0x00,\n      0x06, // Size\n      0x00,\n      0x01, // Format\n      0x00,\n      0x10, // number of track\n      (TimeDivision >> 8) & 0xff,\n      TimeDivision & 0xff, // Data\n    ];\n    /** @type {number} */\n    let i;\n    /** @type {number} */\n    let il;\n    /** @type {number} */\n    let j;\n    /** @type {number} */\n    let jl;\n\n    /**\n     * @param {string} str\n     * @return {Array.<number>}\n     */\n    function stringToArray(str) {\n      /** @type {number} */\n      let i;\n      /** @type {number} */\n      const il = str.length;\n      /** @type {Array.<number>} */\n      const array = new Array(il);\n\n      for (i = 0; i < il; ++i) {\n        array[i] = str.charCodeAt(i);\n      }\n\n      return array;\n    }\n\n    if (this.dataInformation.copy !== void 0) {\n      /** @type {Array.<number>} */\n      let copy = stringToArray(this.dataInformation.copy);\n\n      il = copy.length;\n      copy = [0x00, 0xff, 0x02].concat(this.deltaTimeToByteArray(il), copy);\n      plainTracks[0].unshift(copy);\n    }\n\n    /*\n    if (this.dataInformation['titl'] !== void 0) {\n      let title = stringToArray(this.dataInformation['titl']);\n      il = title.length;\n      title = [0x00, 0xff, 0x03].concat(\n        this.deltaTimeToByteArray(il),\n        title\n      );\n      plainTracks[0].unshift(title);\n    }\n    */\n\n    for (i = 0, il = plainTracks.length; i < il; ++i) {\n      const track = plainTracks[i];\n      trackData = [];\n      for (j = 0, jl = track.length; j < jl; ++j) {\n        Array.prototype.push.apply(trackData, track[j]);\n      }\n\n      jl = trackData.length;\n      trackHeader = [\n        0x4d,\n        0x54,\n        0x72,\n        0x6b, // \"MTrk\"\n        (jl >> 24) & 0xff,\n        (jl >> 16) & 0xff,\n        (jl >> 8) & 0xff,\n        jl & 0xff,\n      ];\n      result = result.concat(trackHeader, trackData);\n    }\n\n    return new Uint8Array(result);\n  }\n\n  /**\n   * @param {number} deltaTime\n   * @return {Array.<number>}\n   */\n  deltaTimeToByteArray(deltaTime) {\n    /** @type {Array.<number>} */\n    const array = [];\n\n    while (deltaTime >= 0x80) {\n      array.unshift((deltaTime & 0x7f) | (array.length === 0 ? 0 : 0x80));\n      deltaTime >>>= 7;\n    }\n    array.unshift(deltaTime | (array.length === 0 ? 0 : 0x80));\n\n    return array;\n  }\n}\n","import PSGConverter from './PSGConverter';\nimport MakiMabiSequence from './mms';\nimport { MetaEvent, ChannelEvent, SystemExclusiveEvent } from './midi_event';\n/**\n * @classdesc   MabiIcco MML File Parser\n *\n * @author      Logue <logue@hotmail.co.jp>\n * @copyright   2019 Masashi Yoshikawa <https://logue.dev/> All rights reserved.\n * @license     MIT\n */\nexport default class MabiIcco extends MakiMabiSequence {\n  /**\n   * @param {ByteArray} input\n   * @param {Object=} optParams\n   */\n  constructor(input, optParams = {}) {\n    super(input, optParams);\n    /** @type {array} 入力データ。行ごとに配列化 */\n    this.input =\n      String.fromCharCode\n        .apply('', new Uint16Array(input))\n        .split(/\\r\\n|\\r|\\n/) || [];\n    /** @type {Array.<Array.<Object>>} 全トラックの演奏情報 */\n    this.tracks = [];\n    /** @type {Array.<Array.<Uint8Array>>} WMLに送る生のMIDIイベント */\n    this.plainTracks = [];\n    /** @param {number} トラック数 */\n    this.numberOfTracks = 1;\n    /** @type {number} 分解能 */\n    this.timeDivision = optParams.timeDivision || 96;\n  }\n\n  /**\n   * パース処理\n   */\n  parse() {\n    this.parseHeader();\n    this.parseTracks();\n    this.toPlainTrack();\n  }\n\n  /**\n   * ヘッダーメタ情報をパース\n   */\n  parseHeader() {\n    /** @type {TextEncoder} */\n    this.encoder = new TextEncoder('utf-8');\n\n    /** @type {array} 各トラックごと複数存在する変数名 */\n    const multipleKeys = [\n      'mml-track',\n      'name',\n      'program',\n      'songProgram',\n      'panpot',\n    ];\n    const ret = {};\n    /** @type {number} トラック番号（ヘッダー情報があるので初期値は-1） */\n    let trackNo = -1;\n    ret.track = [];\n\n    for (let i = 0; i < this.input.length; i++) {\n      const line = this.input[i].trim();\n      if (i === 0) {\n        if (line !== '[mml-score]') {\n          throw new Error('Not MabiIcco File.');\n        }\n        continue;\n      }\n      const [key, value] = line.split('=');\n      if (multipleKeys.includes(key)) {\n        if (key === 'mml-track') {\n          trackNo++;\n          ret.track[trackNo] = {};\n          // 「-」が含まれる名前を変数名として使うと面倒なので・・・。\n          ret.track[trackNo].mml = value;\n        } else {\n          ret.track[trackNo][key] = key === 'name' ? value : value | 0;\n        }\n      } else {\n        ret[key] = value;\n      }\n    }\n    /** @param {string} タイトル */\n    this.title = ret.title;\n    /** @param {string} 著者情報 */\n    this.author = ret.author;\n    /** @param {array} グローバルテンポ情報（テンポ変更のTickとテンポ？） */\n    const mmiTempo = ret.tempo !== '' ? ret.tempo.split('T') : [0, 120];\n    /** @param {number} 分解能 */\n    this.timeDivision = 96;\n    /** @param {number} テンポ */\n    this.tempo = mmiTempo[1] | 0;\n    /** @param {array} 拍子記号 */\n    const timeSig = ret.time.split('/');\n    /** @type {array}  */\n    const headerTrack = [];\n    // GM Reset\n    headerTrack.push(\n      new SystemExclusiveEvent(\n        'SystemExclusive',\n        0,\n        0,\n        [0x7e, 0x7f, 0x09, 0x01]\n      )\n    );\n    // 曲名と著者情報を付加\n    headerTrack.push(new MetaEvent('SequenceTrackName', 0, 0, [this.title]));\n    headerTrack.push(new MetaEvent('CopyrightNotice', 0, 0, [this.author]));\n    headerTrack.push(\n      new MetaEvent('TimeSignature', 0, 0, [\n        timeSig[0] | 0 || 4,\n        timeSig[1] | 0 || 4,\n        0,\n        0,\n      ])\n    );\n    headerTrack.push(\n      new MetaEvent('SetTempo', 0, 0, [Math.floor(60000000 / this.tempo)])\n    );\n    headerTrack.push(new MetaEvent('EndOfTrack', 0, 0));\n    this.tracks.push(headerTrack);\n\n    this.input = ret.track;\n    // console.log(this);\n  }\n\n  /**\n   * MML parse\n   */\n  parseTracks() {\n    /** @type {array} MIDIイベント */\n    let track = [];\n    /** @type {array} 終了時間比較用 */\n    const endTimes = [];\n\n    for (let ch = 0; ch < this.input.length; ch++) {\n      /** @type {array} 現在のチャンネルの情報 */\n      const current = this.input[ch];\n      if (!current.mml.match(/^(?:MML@)(.*)/gm)) {\n        continue;\n      }\n\n      /** @type {array} MMLの配列（簡易マッチ） */\n      const mmls = RegExp.$1.split(',');\n\n      // 楽器名\n      track.push(new MetaEvent('InsturumentName', 0, 48, [current.name]));\n      // プログラムチェンジ\n      track.push(new ChannelEvent('ProgramChange', 0, 96, ch, current.program));\n      if (current.songProgram !== -1) {\n        // コーラス用\n        track.push(\n          new ChannelEvent('ProgramChange', 0, 112, 15, current.songProgram)\n        );\n      }\n      // パン(CC:0x10)\n      track.push(\n        new ChannelEvent('ControlChange', 0, 154, ch, 10, current.panpot)\n      );\n\n      // MMLの各チャンネルの処理\n      for (let chord = 0; chord < current.mml.length; chord++) {\n        let currentCh = ch;\n        if (chord === 3 && current.songProgram !== -1) {\n          // ch 16はコーラス用\n          // TODO: 現在の実装では一人しかコーラスを反映させることができない。（男女のコーラスを同時に鳴らせない）\n          // 複数の奏者でコーラスが指定されていた場合、男性女性用関係なく一番うしろのコーラスで指定された音色でマージされる。\n          currentCh = 15;\n        }\n        if (mmls[chord] === void 0) {\n          continue;\n        }\n\n        /** @param {PSGConverter} */\n        const mml2Midi = new PSGConverter({\n          timeDivision: this.timeDivision,\n          channel: currentCh,\n          timeOffset: 386,\n          mml: mmls[chord],\n          igonoreTempo: currentCh === 1,\n        });\n        // トラックにマージ\n        track = track.concat(mml2Midi.events);\n        endTimes.push(mml2Midi.endTime);\n      }\n\n      // トラック終了\n      track.concat(new MetaEvent('EndOfTrack', 0, Math.max(endTimes)));\n      this.tracks.push(track);\n    }\n    this.numberOfTracks = this.tracks.length;\n  }\n}\n","import PSGConverter from './PSGConverter';\nimport Ini from 'ini';\nimport { MetaEvent, ChannelEvent, SystemExclusiveEvent } from './midi_event';\n/**\n * @classdesc   MakiMabi Sequence File Parser\n *\n * @author      Logue <logue@hotmail.co.jp>\n * @copyright   2019 Masashi Yoshikawa <https://logue.dev/> All rights reserved.\n * @license     MIT\n */\nexport default class MakiMabiSequence {\n  /**\n   * @param {ByteArray} input\n   * @param {Object=} optParams\n   */\n  constructor(input, optParams = {}) {\n    /** @type {string} */\n    const string = String.fromCharCode.apply('', new Uint16Array(input));\n    /** @type {Ini} MMSファイルをパースしたもの */\n    this.input = Ini.parse(string) || {};\n    /** @type {Array.<Array.<Object>>} 全トラックの演奏情報 */\n    this.tracks = [];\n    /** @type {Array.<Array.<Uint8Array>>} WMLに送る生のMIDIイベント */\n    this.plainTracks = [];\n    /** @param {number} トラック数 */\n    this.numberOfTracks = 1;\n    /** @type {number} 分解能 */\n    this.timeDivision = optParams.timeDivision || 96;\n  }\n\n  /**\n   * パース処理\n   */\n  parse() {\n    this.parseHeader();\n    this.parseTracks();\n    this.toPlainTrack();\n  }\n  /**\n   * ヘッダーメタ情報をパース\n   */\n  parseHeader() {\n    /** @type {TextEncoder} */\n    this.encoder = new TextEncoder('shift_jis');\n    /** @type {object} インフォメーション情報 */\n    const header = this.input.infomation; // informationじゃない\n    /** @type {string} タイトル */\n    this.title = header.title;\n    /** @type {string} 著者情報 */\n    this.author = header.auther; // authorじゃない。\n    /** @param {number} 解像度 */\n    this.timeDivision = header.timeBase | 0 || 96;\n    /** @type {array} まきまびしーくの楽器番号変換テーブル（MabiIccoのMMSFile.javaのテーブルを流用） */\n    this.mmsInstTable = [\n      0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 65, 66, 67,\n      68, 69, 70, 71, 72, 73, 74, 75, 76, 18,\n    ];\n\n    // 曲名と著者情報を付加\n\n    /** @type {array}  */\n    const headerTrack = [];\n    // GM Reset\n    headerTrack.push(\n      new SystemExclusiveEvent(\n        'SystemExclusive',\n        0,\n        0,\n        [0x7e, 0x7f, 0x09, 0x01]\n      )\n    );\n    headerTrack.push(new MetaEvent('SequenceTrackName', 0, 0, [this.title]));\n    headerTrack.push(new MetaEvent('CopyrightNotice', 0, 0, [this.author]));\n    headerTrack.push(\n      new MetaEvent('TimeSignature', 0, 0, [\n        header.rythmNum | 0 || 4,\n        header.rythmBase | 0 || 4,\n        0,\n        0,\n      ])\n    );\n    headerTrack.push(new MetaEvent('EndOfTrack', 0, 0));\n    this.tracks.push(headerTrack);\n\n    // infomationおよびmms-fileを取り除く\n    delete this.input.infomation;\n    delete this.input['mms-file'];\n  }\n  /**\n   * MML parse\n   */\n  parseTracks() {\n    /** @type {array} MIDIイベント */\n    let track = [];\n    /** @type {array} 終了時間比較用 */\n    const endTimes = [];\n    /** @type {number} チャンネル */\n    let ch = 0;\n\n    for (const part in this.input) {\n      if (!Object.prototype.hasOwnProperty.call(this.input, part)) {\n        continue;\n      }\n      const currentPart = this.input[part];\n      /** @param {array} MMLの配列 */\n      const mmls = [\n        currentPart.ch0_mml,\n        currentPart.ch1_mml,\n        currentPart.ch2_mml,\n      ];\n      /** @param {number} パンポット */\n      const panpot = Number(currentPart.panpot) + 64;\n\n      // 楽器名\n      track.push(new MetaEvent('InsturumentName', 0, 48, [currentPart.name]));\n      // プログラムチェンジ\n      track.push(\n        new ChannelEvent(\n          'ProgramChange',\n          0,\n          96,\n          ch,\n          this.mmsInstTable[currentPart.instrument] | 0\n        )\n      );\n      // パン\n      track.push(new ChannelEvent('ControlChange', 0, 154, ch, 10, panpot));\n\n      // MMLの各チャンネルの処理\n      for (const chord in mmls) {\n        if (!Object.prototype.hasOwnProperty.call(mmls, chord)) {\n          continue;\n        }\n        /** @param {PSGConverter} */\n        const mml2Midi = new PSGConverter({\n          timeDivision: this.timeDivision,\n          channel: ch,\n          timeOffset: 386,\n          mml: mmls[chord],\n        });\n        // トラックにマージ\n        track = track.concat(mml2Midi.events);\n        endTimes.push(mml2Midi.endTime);\n      }\n      ch++;\n      // トラック終了\n      track.concat(new MetaEvent('EndOfTrack', 0, Math.max(endTimes)));\n      this.tracks.push(track);\n    }\n    this.numberOfTracks = this.tracks.length;\n  }\n\n  /**\n   * WebMidiLink信号に変換\n   */\n  toPlainTrack() {\n    for (let i = 0; i < this.tracks.length; i++) {\n      /** @type {array} トラックのイベント */\n      let rawTrackEvents = [];\n\n      /** @type {array} 全イベント */\n      let rawEvents = [];\n\n      /** @type {array} */\n      const events = this.tracks[i];\n\n      for (const event of events) {\n        /** @var {Uint8Array} WebMidiLink信号 */\n        let raw;\n\n        if (event instanceof ChannelEvent) {\n          switch (event.subtype) {\n            case 'NoteOn':\n              // console.log(event);\n              if (event.parameter2 === 0) {\n                raw = new Uint8Array([\n                  0x80 | event.channel,\n                  event.parameter1,\n                  event.parameter2,\n                ]);\n              } else {\n                raw = new Uint8Array([\n                  0x90 | event.channel,\n                  event.parameter1,\n                  event.parameter2,\n                ]);\n              }\n              break;\n            case 'NoteOff':\n              raw = new Uint8Array([\n                0x80 | event.channel,\n                event.parameter1,\n                event.parameter2,\n              ]);\n              break;\n            case 'ControlChange':\n              raw = new Uint8Array([\n                0xb0 | event.channel,\n                event.parameter1,\n                event.parameter2,\n              ]);\n              break;\n            case 'ProgramChange':\n              raw = new Uint8Array([0xc0 | event.channel, event.parameter1]);\n              break;\n          }\n        } else if (event instanceof MetaEvent) {\n          // Metaイベントの内容は実際使われない。単なる配列の数合わせのためのプレースホルダ（音を鳴らすことには関係ない処理だから）\n          /** @type {Uint8Array} */\n          const data = this.encoder.encode(event.data);\n          switch (event.subtype) {\n            case 'TextEvent':\n              raw = new Uint8Array([0xff, 0x01].concat(data));\n              break;\n            case 'SequenceTrackName':\n              raw = new Uint8Array([0xff, 0x03].concat(data));\n              break;\n            case 'CopyrightNotice':\n              raw = new Uint8Array([0xff, 0x02].concat(data));\n              break;\n            case 'InsturumentName':\n              raw = new Uint8Array([0xff, 0x04].concat(data));\n              break;\n            case 'SetTempo':\n              raw = new Uint8Array([0xff, 0x51].concat(data));\n              break;\n            case 'TimeSignature':\n              raw = new Uint8Array([0xff, 0x58].concat(data));\n              break;\n            case 'EndOfTrack':\n              raw = new Uint8Array([0xff, 0x2f]);\n              break;\n          }\n        } else if (event instanceof SystemExclusiveEvent) {\n          raw = new Uint8Array([0xf0, 0x05].concat(event.data));\n        }\n        rawEvents = rawEvents.concat(raw);\n      }\n      rawTrackEvents = rawTrackEvents.concat(rawEvents);\n\n      this.plainTracks[i] = rawTrackEvents;\n    }\n  }\n}\n","import PSGConverter from './PSGConverter';\nimport MakiMabiSequence from './mms';\nimport { MetaEvent } from './midi_event';\n/**\n * @classdesc   MapleStory2 Mml Parser\n *\n * @author      Logue <logue@hotmail.co.jp>\n * @copyright   2019 Masashi Yoshikawa <https://logue.dev/> All rights reserved.\n * @license     MIT\n */\nexport default class MapleStory2Mml extends MakiMabiSequence {\n  /**\n   * @param {ByteArray} input\n   * @param {Object=} optParams\n   */\n  constructor(input, optParams = {}) {\n    super(input, optParams);\n    /** @type {TextEncoder} */\n    this.encoder = new TextEncoder('utf-8');\n    /** @type {DOMParser} */\n    const parser = new DOMParser();\n    /** @type {Document} */\n    const doc = parser.parseFromString(\n      String.fromCharCode.apply('', new Uint16Array(input)),\n      'text/xml'\n    );\n    /** @param {Element} */\n    this.input = doc.querySelectorAll('ms2 > *');\n    /** @type {Array.<Array.<Object>>} 全トラックの演奏情報 */\n    this.tracks = [];\n    /** @type {Array.<Array.<Uint8Array>>} WMLに送る生のMIDIイベント */\n    this.plainTracks = [];\n    /** @param {number} トラック数 */\n    this.numberOfTracks = 1;\n    /** @type {number} 解像度 */\n    this.timeDivision = optParams.timeDivision || 96;\n  }\n\n  /**\n   */\n  parse() {\n    // this.parseHeader();\n    // this.parseDataInformation();\n    this.parseTracks();\n\n    this.toPlainTrack();\n  }\n\n  /**\n   * MML parse\n   */\n  parseTracks() {\n    /** @type {array} MIDIイベント */\n    let track = [];\n    /** @type {array} 終了時間比較用 */\n    const endTimes = [];\n\n    for (const i of this.input) {\n      /** @param {PSGConverter} */\n      const mml2Midi = new PSGConverter({\n        timeDivision: this.timeDivision,\n        channel: 0,\n        mml: this.input[i].textContent.trim(),\n        ignoreTempo: false,\n      });\n      track = track.concat(mml2Midi.events);\n      endTimes.push(mml2Midi.endTime);\n    }\n\n    // トラック終了\n    track.concat(new MetaEvent('EndOfTrack', 0, Math.max(endTimes)));\n    this.tracks.push(track);\n  }\n}\n","/**\n * Riff Parser class\n */\nexport default class Riff {\n  /**\n   * @param {ByteArray} input input buffer.\n   * @param {Object=} optParams option parameters.\n   */\n  constructor(input, optParams = {}) {\n    /** @type {ByteArray} */\n    this.input = input;\n    /** @type {number} */\n    this.ip = optParams.index || 0;\n    /** @type {number} */\n    this.length = optParams.length || input.length - this.ip;\n    /** @type {Array.<RiffChunk>} */\n    this.chunkList = [];\n    /** @type {number} */\n    this.offset = this.ip;\n    /** @type {boolean} */\n    this.padding = optParams.padding !== void 0 ? optParams.padding : true;\n    /** @type {boolean} */\n    this.bigEndian =\n      optParams.bigEndian !== void 0 ? optParams.bigEndian : false;\n  }\n\n  /**\n   */\n  parse() {\n    /** @type {number} */\n    const length = this.length + this.offset;\n\n    this.chunkList = [];\n\n    while (this.ip < length) {\n      this.parseChunk();\n    }\n  }\n\n  /**\n   */\n  parseChunk() {\n    /** @type {ByteArray} */\n    const input = this.input;\n    /** @type {number} */\n    let ip = this.ip;\n    /** @type {number} */\n    let size;\n\n    this.chunkList.push(\n      new RiffChunk(\n        String.fromCharCode(input[ip++], input[ip++], input[ip++], input[ip++]),\n        (size = this.bigEndian\n          ? ((input[ip++] << 24) |\n              (input[ip++] << 16) |\n              (input[ip++] << 8) |\n              input[ip++]) >>>\n            0\n          : (input[ip++] |\n              (input[ip++] << 8) |\n              (input[ip++] << 16) |\n              (input[ip++] << 24)) >>>\n            0),\n        ip\n      )\n    );\n\n    ip += size;\n\n    // padding\n    if (this.padding && ((ip - this.offset) & 1) === 1) {\n      ip++;\n    }\n\n    this.ip = ip;\n  }\n\n  /**\n   * @param {number} index chunk index.\n   * @return {?RiffChunk}\n   */\n  getChunk(index) {\n    /** @type {RiffChunk} */\n    const chunk = this.chunkList[index];\n\n    if (chunk === void 0) {\n      return null;\n    }\n\n    return chunk;\n  }\n\n  /**\n   * @return {number}\n   */\n  getNumberOfChunks() {\n    return this.chunkList.length;\n  }\n}\n\n/**\n * Riff Chunk Structure\n * @interface\n */\nclass RiffChunk {\n  /**\n   * @param {string} type\n   * @param {number} size\n   * @param {number} offset\n   */\n  constructor(type, size, offset) {\n    /** @type {string} */\n    this.type = type;\n    /** @type {number} */\n    this.size = size;\n    /** @type {number} */\n    this.offset = offset;\n  }\n}\n","import { ChannelEvent, SystemExclusiveEvent, MetaEvent } from './midi_event';\nimport Meta from './meta';\nimport Riff from './riff';\n\n/**\n * Standard Midi File Parser class\n */\nexport default class SMF {\n  /**\n   * @param {ByteArray} input input buffer.\n   * @param {Object=} optParams option parameters.\n   */\n  constructor(input, optParams = {}) {\n    optParams.padding = false;\n    optParams.bigEndian = true;\n\n    /** @type {ByteArray} */\n    this.input = input;\n    /** @type {number} */\n    this.ip = optParams.index || 0;\n    /** @type {number} */\n    this.chunkIndex = 0;\n    /**\n     * @type {Riff}\n     * @private\n     */\n    this.riffParser_ = new Riff(input, optParams);\n\n    // MIDI File Information\n\n    /** @type {number} */\n    this.formatType = 0;\n    /** @type {number} */\n    this.numberOfTracks = 0;\n    /** @type {number} */\n    this.timeDivision = 480;\n    /** @type {Array.<Array.<Midi.Event>>} */\n    this.tracks = [];\n    /** @type {Array.<Array.<ByteArray>>} */\n    this.plainTracks = [];\n\n    /** @type {number} */\n    this.version = Meta.version;\n    /** @type {string} */\n    this.build = Meta.build;\n  }\n\n  /**\n   */\n  parse() {\n    /** @type {number} */\n    let i = 0;\n    /** @type {number} */\n    let il = 0;\n\n    // parse riff chunks\n    this.riffParser_.parse();\n\n    // parse header chunk\n    this.parseHeaderChunk();\n\n    // parse track chunks\n    for (i = 0, il = this.numberOfTracks; i < il; ++i) {\n      this.parseTrackChunk();\n    }\n  }\n\n  /**\n   */\n  parseHeaderChunk() {\n    /** @type {?{type: string, size: number, offset: number}} */\n    const chunk = this.riffParser_.getChunk(this.chunkIndex++);\n    /** @type {ByteArray} */\n    const data = this.input;\n    /** @type {number} */\n    let ip = chunk.offset;\n\n    if (!chunk || chunk.type !== 'MThd') {\n      throw new Error('invalid header signature');\n    }\n\n    this.formatType = (data[ip++] << 8) | data[ip++];\n    this.numberOfTracks = (data[ip++] << 8) | data[ip++];\n    this.timeDivision = (data[ip++] << 8) | data[ip++];\n  }\n\n  /**\n   */\n  parseTrackChunk() {\n    /** @type {?{type: string, size: number, offset: number}} */\n    const chunk = this.riffParser_.getChunk(this.chunkIndex++);\n    /** @type {ByteArray} */\n    const data = this.input;\n    /** @type {number} */\n    let ip = chunk.offset;\n    /** @type {number} */\n    let size = 0;\n    /** @type {number} */\n    let deltaTime = 0;\n    /** @type {number} */\n    let eventType = 0;\n    /** @type {number} */\n    let channel = 0;\n    /** @type {number} */\n    let prevEventType = -1;\n    /** @type {number} */\n    let prevChannel = -1;\n    /** @type {number} */\n    let tmp = 0;\n    /** @type {number} */\n    let totalTime = 0;\n    /** @type {number} */\n    let offset = 0;\n    /** @type {number} */\n    let length = 0;\n    /** @type {number} */\n    let status = 0;\n    /** @type {Event} */\n    let event;\n    /** @type {ByteArray} */\n    let plainBytes;\n\n    /** @return {number} */\n    const readNumber = () => {\n      /** @type {number} */\n      let result = 0;\n\n      tmp = 0;\n\n      do {\n        tmp = data[ip++];\n        result = (result << 7) | (tmp & 0x7f);\n      } while ((tmp & 0x80) !== 0);\n\n      return result;\n    };\n\n    if (!chunk || chunk.type !== 'MTrk') {\n      throw new Error('invalid header signature');\n    }\n\n    size = chunk.offset + chunk.size;\n    const eventQueue = [];\n    const plainQueue = [];\n\n    while (ip < size) {\n      // delta time\n      deltaTime = readNumber();\n      totalTime += deltaTime;\n\n      // offset\n      offset = ip;\n\n      // event type value, midi channel\n      status = data[ip++];\n      eventType = (status >> 4) & 0xf;\n      channel = status & 0xf;\n\n      // run status rule\n      if (eventType < 8) {\n        eventType = prevEventType;\n        channel = prevChannel;\n        status = (prevEventType << 4) | prevChannel;\n        ip--;\n        offset--;\n      } else {\n        prevEventType = eventType;\n        prevChannel = channel;\n      }\n\n      // TODO\n      const table = [\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        'NoteOff', // 0x8\n        'NoteOn',\n        'NoteAftertouch',\n        'ControlChange',\n        'ProgramChange',\n        'ChannelAftertouch',\n        'PitchBend',\n      ];\n\n      switch (eventType) {\n        // channel events\n        case 0x8:\n        /* FALLTHROUGH */\n        case 0x9:\n        /* FALLTHROUGH */\n        case 0xa:\n        /* FALLTHROUGH */\n        case 0xb:\n        /* FALLTHROUGH */\n        case 0xd:\n        /* FALLTHROUGH */\n        case 0xe:\n          event = new ChannelEvent(\n            table[eventType],\n            deltaTime,\n            totalTime,\n            channel,\n            data[ip++],\n            data[ip++]\n          );\n          break;\n        case 0xc:\n          event = new ChannelEvent(\n            table[eventType],\n            deltaTime,\n            totalTime,\n            channel,\n            data[ip++]\n          );\n          break;\n        // meta events, system exclusive event\n        case 0xf:\n          switch (channel) {\n            // SysEx event\n            case 0x0:\n              tmp = readNumber();\n              if (data[ip + tmp - 1] !== 0xf7) {\n                throw new Error('invalid SysEx event');\n              }\n              event = new SystemExclusiveEvent(\n                'SystemExclusive',\n                deltaTime,\n                totalTime,\n                data.subarray(ip, (ip += tmp) - 1)\n              );\n              break;\n            case 0x7:\n              tmp = readNumber();\n              event = new SystemExclusiveEvent(\n                'SystemExclusive(F7)',\n                deltaTime,\n                totalTime,\n                data.subarray(ip, (ip += tmp))\n              );\n              break;\n            // meta event\n            case 0xf:\n              eventType = data[ip++];\n              tmp = readNumber();\n              switch (eventType) {\n                case 0x00: // sequence number\n                  event = new MetaEvent(\n                    'SequenceNumber',\n                    deltaTime,\n                    totalTime,\n                    [data[ip++], data[ip++]]\n                  );\n                  break;\n                case 0x01: // text event\n                  event = new MetaEvent('TextEvent', deltaTime, totalTime, [\n                    String.fromCharCode.apply(\n                      null,\n                      data.subarray(ip, (ip += tmp))\n                    ),\n                  ]);\n                  break;\n                case 0x02: // copyright notice\n                  event = new MetaEvent(\n                    'CopyrightNotice',\n                    deltaTime,\n                    totalTime,\n                    [\n                      String.fromCharCode.apply(\n                        null,\n                        data.subarray(ip, (ip += tmp))\n                      ),\n                    ]\n                  );\n                  break;\n                case 0x03: // sequence/track name\n                  event = new MetaEvent(\n                    'SequenceTrackName',\n                    deltaTime,\n                    totalTime,\n                    [\n                      String.fromCharCode.apply(\n                        null,\n                        data.subarray(ip, (ip += tmp))\n                      ),\n                    ]\n                  );\n                  break;\n                case 0x04: // instrument name\n                  event = new MetaEvent(\n                    'InstrumentName',\n                    deltaTime,\n                    totalTime,\n                    [\n                      String.fromCharCode.apply(\n                        null,\n                        data.subarray(ip, (ip += tmp))\n                      ),\n                    ]\n                  );\n                  break;\n                case 0x05: // lyrics\n                  event = new MetaEvent('Lyrics', deltaTime, totalTime, [\n                    String.fromCharCode.apply(\n                      null,\n                      data.subarray(ip, (ip += tmp))\n                    ),\n                  ]);\n                  break;\n                case 0x06: // marker\n                  event = new MetaEvent('Marker', deltaTime, totalTime, [\n                    String.fromCharCode.apply(\n                      null,\n                      data.subarray(ip, (ip += tmp))\n                    ),\n                  ]);\n                  break;\n                case 0x07: // cue point\n                  event = new MetaEvent('CuePoint', deltaTime, totalTime, [\n                    String.fromCharCode.apply(\n                      null,\n                      data.subarray(ip, (ip += tmp))\n                    ),\n                  ]);\n                  break;\n                case 0x20: // midi channel prefix\n                  event = new MetaEvent(\n                    'MidiChannelPrefix',\n                    deltaTime,\n                    totalTime,\n                    [data[ip++]]\n                  );\n                  break;\n                case 0x2f: // end of track\n                  event = new MetaEvent('EndOfTrack', deltaTime, totalTime, []);\n                  break;\n                case 0x51: // set tempo\n                  event = new MetaEvent('SetTempo', deltaTime, totalTime, [\n                    (data[ip++] << 16) | (data[ip++] << 8) | data[ip++],\n                  ]);\n                  break;\n                case 0x54: // smpte offset\n                  event = new MetaEvent('SmpteOffset', deltaTime, totalTime, [\n                    data[ip++],\n                    data[ip++],\n                    data[ip++],\n                    data[ip++],\n                    data[ip++],\n                  ]);\n                  break;\n                case 0x58: // time signature\n                  event = new MetaEvent('TimeSignature', deltaTime, totalTime, [\n                    data[ip++],\n                    data[ip++],\n                    data[ip++],\n                    data[ip++],\n                  ]);\n                  break;\n                case 0x59: // key signature\n                  event = new MetaEvent('KeySignature', deltaTime, totalTime, [\n                    data[ip++],\n                    data[ip++],\n                  ]);\n                  break;\n                case 0x7f: // sequencer specific\n                  event = new MetaEvent(\n                    'SequencerSpecific',\n                    deltaTime,\n                    totalTime,\n                    [data.subarray(ip, (ip += tmp))]\n                  );\n                  break;\n                default:\n                  // unknown\n                  event = new MetaEvent('Unknown', deltaTime, totalTime, [\n                    eventType,\n                    data.subarray(ip, (ip += tmp)),\n                  ]);\n              }\n              break;\n            default:\n              console.warn('unknown message:', status.toString(16));\n          }\n          break;\n        // error\n        default:\n          throw new Error('invalid status');\n      }\n\n      // plain queue\n      length = ip - offset;\n      plainBytes = data.subarray(offset, offset + length);\n      plainBytes[0] = status;\n      if (\n        event instanceof ChannelEvent &&\n        event.subtype === 'NoteOn' &&\n        /** @type {ChannelEvent} */\n        (event).parameter2 === 0\n      ) {\n        event.subtype = table[8];\n        plainBytes = new Uint8Array([\n          0x80 | event.channel,\n          event.parameter1,\n          event.parameter2,\n        ]);\n      }\n      plainQueue.push(plainBytes);\n\n      // event queue\n      eventQueue.push(event);\n    }\n\n    this.tracks.push(eventQueue);\n    this.plainTracks.push(plainQueue);\n  }\n}\n","const { hasOwnProperty } = Object.prototype\n\nconst eol = typeof process !== 'undefined' &&\n  process.platform === 'win32' ? '\\r\\n' : '\\n'\n\nconst encode = (obj, opt) => {\n  const children = []\n  let out = ''\n\n  if (typeof opt === 'string') {\n    opt = {\n      section: opt,\n      whitespace: false,\n    }\n  } else {\n    opt = opt || Object.create(null)\n    opt.whitespace = opt.whitespace === true\n  }\n\n  const separator = opt.whitespace ? ' = ' : '='\n\n  for (const k of Object.keys(obj)) {\n    const val = obj[k]\n    if (val && Array.isArray(val)) {\n      for (const item of val)\n        out += safe(k + '[]') + separator + safe(item) + '\\n'\n    } else if (val && typeof val === 'object')\n      children.push(k)\n    else\n      out += safe(k) + separator + safe(val) + eol\n  }\n\n  if (opt.section && out.length)\n    out = '[' + safe(opt.section) + ']' + eol + out\n\n  for (const k of children) {\n    const nk = dotSplit(k).join('\\\\.')\n    const section = (opt.section ? opt.section + '.' : '') + nk\n    const { whitespace } = opt\n    const child = encode(obj[k], {\n      section,\n      whitespace,\n    })\n    if (out.length && child.length)\n      out += eol\n\n    out += child\n  }\n\n  return out\n}\n\nconst dotSplit = str =>\n  str.replace(/\\1/g, '\\u0002LITERAL\\\\1LITERAL\\u0002')\n    .replace(/\\\\\\./g, '\\u0001')\n    .split(/\\./)\n    .map(part =>\n      part.replace(/\\1/g, '\\\\.')\n        .replace(/\\2LITERAL\\\\1LITERAL\\2/g, '\\u0001'))\n\nconst decode = str => {\n  const out = Object.create(null)\n  let p = out\n  let section = null\n  //          section     |key      = value\n  const re = /^\\[([^\\]]*)\\]$|^([^=]+)(=(.*))?$/i\n  const lines = str.split(/[\\r\\n]+/g)\n\n  for (const line of lines) {\n    if (!line || line.match(/^\\s*[;#]/))\n      continue\n    const match = line.match(re)\n    if (!match)\n      continue\n    if (match[1] !== undefined) {\n      section = unsafe(match[1])\n      if (section === '__proto__') {\n        // not allowed\n        // keep parsing the section, but don't attach it.\n        p = Object.create(null)\n        continue\n      }\n      p = out[section] = out[section] || Object.create(null)\n      continue\n    }\n    const keyRaw = unsafe(match[2])\n    const isArray = keyRaw.length > 2 && keyRaw.slice(-2) === '[]'\n    const key = isArray ? keyRaw.slice(0, -2) : keyRaw\n    if (key === '__proto__')\n      continue\n    const valueRaw = match[3] ? unsafe(match[4]) : true\n    const value = valueRaw === 'true' ||\n      valueRaw === 'false' ||\n      valueRaw === 'null' ? JSON.parse(valueRaw)\n      : valueRaw\n\n    // Convert keys with '[]' suffix to an array\n    if (isArray) {\n      if (!hasOwnProperty.call(p, key))\n        p[key] = []\n      else if (!Array.isArray(p[key]))\n        p[key] = [p[key]]\n    }\n\n    // safeguard against resetting a previously defined\n    // array by accidentally forgetting the brackets\n    if (Array.isArray(p[key]))\n      p[key].push(value)\n    else\n      p[key] = value\n  }\n\n  // {a:{y:1},\"a.b\":{x:2}} --> {a:{y:1,b:{x:2}}}\n  // use a filter to return the keys that have to be deleted.\n  const remove = []\n  for (const k of Object.keys(out)) {\n    if (!hasOwnProperty.call(out, k) ||\n        typeof out[k] !== 'object' ||\n        Array.isArray(out[k]))\n      continue\n\n    // see if the parent section is also an object.\n    // if so, add it to that, and mark this one for deletion\n    const parts = dotSplit(k)\n    let p = out\n    const l = parts.pop()\n    const nl = l.replace(/\\\\\\./g, '.')\n    for (const part of parts) {\n      if (part === '__proto__')\n        continue\n      if (!hasOwnProperty.call(p, part) || typeof p[part] !== 'object')\n        p[part] = Object.create(null)\n      p = p[part]\n    }\n    if (p === out && nl === l)\n      continue\n\n    p[nl] = out[k]\n    remove.push(k)\n  }\n  for (const del of remove)\n    delete out[del]\n\n  return out\n}\n\nconst isQuoted = val =>\n  (val.charAt(0) === '\"' && val.slice(-1) === '\"') ||\n    (val.charAt(0) === \"'\" && val.slice(-1) === \"'\")\n\nconst safe = val =>\n  (typeof val !== 'string' ||\n    val.match(/[=\\r\\n]/) ||\n    val.match(/^\\[/) ||\n    (val.length > 1 &&\n     isQuoted(val)) ||\n    val !== val.trim())\n    ? JSON.stringify(val)\n    : val.replace(/;/g, '\\\\;').replace(/#/g, '\\\\#')\n\nconst unsafe = (val, doUnesc) => {\n  val = (val || '').trim()\n  if (isQuoted(val)) {\n    // remove the single quotes before calling JSON.parse\n    if (val.charAt(0) === \"'\")\n      val = val.substr(1, val.length - 2)\n\n    try {\n      val = JSON.parse(val)\n    } catch (_) {}\n  } else {\n    // walk the val to find the first not-escaped ; character\n    let esc = false\n    let unesc = ''\n    for (let i = 0, l = val.length; i < l; i++) {\n      const c = val.charAt(i)\n      if (esc) {\n        if ('\\\\;#'.indexOf(c) !== -1)\n          unesc += c\n        else\n          unesc += '\\\\' + c\n\n        esc = false\n      } else if (';#'.indexOf(c) !== -1)\n        break\n      else if (c === '\\\\')\n        esc = true\n      else\n        unesc += c\n    }\n    if (esc)\n      unesc += '\\\\'\n\n    return unesc.trim()\n  }\n  return val\n}\n\nmodule.exports = {\n  parse: decode,\n  decode,\n  stringify: encode,\n  encode,\n  safe,\n  unsafe,\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import MabiIcco from './mmi';\nimport MakiMabiSequence from './mms';\nimport MapleStory2Mml from './ms2mml';\nimport Meta from './meta';\nimport Mld from './mld';\nimport SMF from './smf';\nimport ThreeMacroLanguageEditor from './3mle';\n/**\n * Midi Player Class\n */\nexport class Player {\n  /**\n   * @param {string} target WML attach dom\n   */\n  constructor(target = '#wml') {\n    /** @type {number} テンポ（マイクロ秒）*/\n    this.tempo = 500000; // default = 0.5[ms] = 120[bpm]\n    /** @type {HTMLIFrameElement} */\n    this.webMidiLink = null;\n    /** @type {number} */\n    this.resume = 0;\n    /** @type {boolean} */\n    this.pause = true;\n    /** @type {boolean} */\n    this.ready = false;\n    /** @type {number} */\n    this.position = 0;\n    /** @type {Array.<Object>} */\n    this.track = [];\n    /** @type {number} */\n    this.timer = 0;\n    /** @type {Object} TODO: 最低限のプロパティは記述する */\n    this.sequence = {};\n    /** @type {boolean} */\n    this.enableCC111Loop = false;\n    /** @type {boolean} */\n    this.enableFalcomLoop = false;\n    /** @type {boolean} */\n    this.enableMFiLoop = false;\n    /** @type {boolean} */\n    this.enableLoop = false;\n    /** @type {number} */\n    this.tempoRate = 1;\n    /** @type {number} */\n    this.masterVolume = 16383;\n    /** @type {?string} */\n    this.textEvent = '';\n    /** @type {?string} */\n    this.sequenceName = '';\n    /** @type {?string} */\n    this.copyright = '';\n    /** @type {?string} */\n    this.lyrics = '';\n    /** @type {HTMLIFrameElement|Worker} */\n    this.webMidiLink = null;\n    /** @type {number} */\n    this.length = 0;\n    /** @type {number} */\n    this.time = 0;\n    /** @type {number} */\n    this.timeTotal = 0;\n    /** @type {number} */\n    this.loaded = 0;\n    /** @type {Window} */\n    this.window = window;\n    /** @type {Element} */\n    this.target = this.window.document.querySelector(target);\n\n    /** @type {number} */\n    this.version = Meta.version;\n    /** @type {string} */\n    this.build = Meta.build;\n  }\n\n  /**\n   * @param {boolean} enable\n   */\n  setCC111Loop(enable) {\n    this.enableCC111Loop = enable;\n  }\n\n  /**\n   * @param {boolean} enable\n   */\n  setFalcomLoop(enable) {\n    this.enableFalcomLoop = enable;\n  }\n\n  /**\n   * @param {boolean} enable\n   */\n  setMFiLoop(enable) {\n    this.enableMFiLoop = enable;\n  }\n\n  /**\n   * @param {boolean} enable\n   */\n  setLoop(enable) {\n    this.enableLoop = enable;\n  }\n\n  /**\n   */\n  stop() {\n    /** @type {number} */\n    let i;\n\n    this.pause = true;\n    this.resume = window.performance.now();\n\n    if (this.webMidiLink) {\n      for (i = 0; i < 16; ++i) {\n        this.webMidiLink.contentWindow.postMessage(\n          'midi,b' + i.toString(16) + ',78,0',\n          '*'\n        );\n      }\n    }\n  }\n\n  /**\n   * @return {HTMLIframeElement}\n   */\n  getWebMidiLink() {\n    return this.webMidiLink;\n  }\n\n  /**\n   */\n  init() {\n    this.stop();\n    this.initSequence();\n    this.pause = true;\n    this.track = null;\n    this.resume = -1;\n    this.text = null;\n    this.sequence = null;\n    this.sequenceName = null;\n    this.copyright = null;\n    this.lyrics = null;\n    this.textEvent = null;\n    this.length = 0;\n    this.position = 0;\n    this.time = 0;\n    this.timeTotal = 0;\n\n    this.window.clearTimeout(this.timer);\n\n    /** @type {Player} */\n    const player = this;\n    if (this.ready) {\n      this.sendInitMessage();\n    } else {\n      this.window.addEventListener(\n        'message',\n        (ev) => {\n          if (ev.data === 'link,ready') {\n            player.sendInitMessage();\n          }\n        },\n        false\n      );\n    }\n  }\n\n  /**\n   */\n  initSequence() {\n    this.tempo = 500000;\n    this.position = 0;\n\n    this.sendInitMessage();\n    this.pause = false;\n  }\n\n  /**\n   */\n  play() {\n    /** @type {Player} */\n    const player = this;\n\n    if (!this.webMidiLink) {\n      throw new Error('WebMidiLink not found');\n    }\n\n    if (this.ready) {\n      if (this.track) {\n        this.length = this.track.length;\n        if (this.track instanceof Array && this.position >= this.length) {\n          this.position = 0;\n        }\n        this.playSequence();\n      } else {\n        console.warn('Midi file is not loaded.');\n      }\n    } else {\n      this.window.addEventListener(\n        'message',\n        (ev) => {\n          if (ev.data === 'link,ready') {\n            player.ready = true;\n            player.webMidiLink.style.height =\n              this.webMidiLink.contentWindow.document.body.scrollHeight + 'px';\n            player.playSequence();\n          }\n        },\n        false\n      );\n    }\n  }\n\n  /**\n   * シーケンス終了時\n   */\n  onSequenceEnd() {\n    console.log('EOF');\n    this.webMidiLink.contentWindow.postMessage('endoftrack', '*');\n  }\n\n  /**\n   */\n  sendInitMessage() {\n    /** @type {Window} */\n    const win = this.webMidiLink.contentWindow;\n    /** @type {number} */\n    let i;\n\n    for (i = 0; i < 16; ++i) {\n      // all sound off\n      win.postMessage('midi,b' + i.toString(16) + ',128,0', '*');\n      // volume\n      win.postMessage('midi,b' + i.toString(16) + ',07,64', '*');\n      // panpot\n      win.postMessage('midi,b' + i.toString(16) + ',0a,40', '*');\n      // pitch bend\n      win.postMessage('midi,e' + i.toString(16) + ',00,40', '*');\n      // pitch bend range\n      win.postMessage('midi,b' + i.toString(16) + ',64,00', '*');\n      win.postMessage('midi,b' + i.toString(16) + ',65,00', '*');\n      win.postMessage('midi,b' + i.toString(16) + ',06,02', '*');\n      win.postMessage('midi,b' + i.toString(16) + ',26,00', '*');\n    }\n    this.sendGmReset();\n  }\n\n  /**\n   * @param {string|Worker} port WebMidiLink url.\n   */\n  setWebMidiLink(port = './wml.html') {\n    /** @type {Player} */\n    const player = this;\n\n    const process = (ev) => {\n      if (typeof ev.data === 'string') {\n        const msg = ev.data.split(',');\n\n        if (msg[0] === 'link') {\n          // console.log(ev.data);\n          if (msg[1] === 'ready') {\n            player.ready = true;\n            player.loaded = 100;\n            player.setMasterVolume(player.masterVolume);\n          } else if (msg[1] === 'progress') {\n            // console.log(msg[2]);\n            player.loaded = Math.round((msg[2] / msg[3]) * 10000);\n          }\n        }\n      }\n    };\n\n    if (typeof port === 'string') {\n      // Clear self\n      if (this.webMidiLink) {\n        this.webMidiLink.parentNode.removeChild(this.webMidiLink);\n      }\n\n      // Clear parent DOM\n      if (this.target.firstChild) {\n        this.target.removeChild(this.target.firstChild);\n      }\n\n      /** @type {HTMLIFrameElement} */\n      const iframe = (this.webMidiLink =\n        /** @type {HTMLIFrameElement} */\n        (this.window.document.createElement('iframe')));\n      iframe.src = port;\n      iframe.className = 'wml';\n\n      this.target.appendChild(iframe);\n      this.window.addEventListener('message', process, false);\n\n      const resizeHeight = () => {\n        iframe.style.height =\n          this.webMidiLink.contentWindow.document.body.scrollHeight + 'px';\n      };\n\n      this.window.addEventListener('load', resizeHeight, false);\n\n      let timer = 0;\n      this.window.addEventListener(\n        'resize',\n        () => {\n          if (timer > 0) {\n            clearTimeout(timer);\n          }\n          timer = setTimeout(resizeHeight, 100);\n        },\n        false\n      );\n    } else {\n      // Worker Mode\n      this.webMidiLink.addEventListener('message', process, false);\n    }\n  }\n\n  /**\n   * マスターボリュームを変更\n   * @param {number} volume\n   */\n  setMasterVolume(volume) {\n    this.masterVolume = volume;\n\n    if (this.webMidiLink) {\n      this.webMidiLink.contentWindow.postMessage(\n        'midi,f0,7f,7f,04,01,' +\n          [\n            ('0' + (volume & 0x7f).toString(16)).substr(-2),\n            ('0' + ((volume >> 7) & 0x7f).toString(16)).substr(-2),\n            '7f',\n          ].join(','),\n        '*'\n      );\n    }\n  }\n\n  /**\n   * テンポ変更\n   * @param {number} tempo\n   */\n  setTempoRate(tempo) {\n    this.tempoRate = tempo;\n  }\n\n  /**\n   */\n  playSequence() {\n    /** @type {Player} */\n    const player = this;\n    /** @type {number} 分解能 */\n    const timeDivision = this.sequence.timeDivision;\n    /** @type {Array.<Object>} */\n    const mergedTrack = this.track;\n    /** @type {Window} */\n    const webMidiLink = this.webMidiLink.contentWindow;\n    /** @type {number} */\n    let pos = this.position || 0;\n    /** @type {Array.<?{pos: number}>} */\n    const mark = [];\n\n    const update = () => {\n      /** @type {number} */\n      const time = mergedTrack[pos].time;\n      /** @type {number} */\n      const length = mergedTrack.length;\n      /** @type {Object} TODO */\n      let event;\n      /** @type {?Array.<string>} */\n      let match;\n      /** @type {*} */\n      let tmp;\n      /** @type {number} */\n      let procTime = window.performance.now();\n\n      if (player.pause) {\n        player.resume = procTime - player.resume;\n        return;\n      }\n\n      do {\n        event = mergedTrack[pos].event;\n\n        switch (event.subtype) {\n          case 'TextEvent': // 0x01\n            // 主に歌詞などが入っている。MIDI作成者によってはデバッグ情報やお遊びも・・・。\n            player.textEvent = event.data[0];\n            break;\n          case 'Lyrics': // 0x05\n            // カラオケデーターが入っている。Textとの違いは、どの位置で表示するかやページ送りなどの制御コードが含まれている。\n            // とはいっても、単なるテキストデータ。\n            // KAR形式とYAMAHA独自のXF形式というカラオケ専用の書式がある。\n            // カラオケのパーサーは本プログラムでは実装しない。\n            // KAR形式：https://www.mixagesoftware.com/en/midikit/help/HTML/karaoke_formats.html\n            // XF形式：https://jp.yamaha.com/files/download/other_assets/7/321757/xfspc.pdf\n            player.lyrics = event.data[0];\n            break;\n          case 'Maker': // 0x06\n            if (player.enableFalcomLoop) {\n              // A-B Loop (Ys Eternal 2 Loop)\n              switch (event.data[0]) {\n                case 'A':\n                  mark[0] = {\n                    pos: pos,\n                  };\n                  break;\n                case 'B':\n                  if (mark[0] && typeof mark[0].pos === 'number') {\n                    pos = mark[0].pos;\n                    player.timer = player.window.setTimeout(update, 0);\n                    player.position = pos;\n                    return;\n                  }\n                  break;\n              }\n            }\n\n            if (player.enableMFiLoop) {\n              // MFi Loop\n              match = event.data[0].match(\n                /^LOOP_(START|END)=ID:(\\d+),COUNT:(-?\\d+)$/\n              );\n              if (match) {\n                if (match[1] === 'START') {\n                  mark[match[2] | 0] = mark[match[2]] || {\n                    pos: pos,\n                    count: match[3] | 0,\n                  };\n                } else if (match[1] === 'END' && player.enableMFiLoop) {\n                  tmp = mark[match[2] | 0];\n                  if (tmp.count !== 0) {\n                    // loop jump\n                    if (tmp.count > 0) {\n                      tmp.count--;\n                    }\n                    pos = tmp.pos;\n                    player.timer = player.window.setTimeout(update, 0);\n                    player.position = pos;\n                    return;\n                  } else {\n                    // loop end\n                    mark[match[2] | 0] = null;\n                  }\n                }\n              }\n            }\n            break;\n          case 'SetTempo': // 0x51\n            player.tempo = event.data[0];\n            break;\n        }\n\n        // CC#111 Loop\n        if (event.subtype === 'ControlChange' && event.parameter1 === 111) {\n          mark[0] = {\n            pos: pos,\n          };\n        }\n\n        // send message\n        webMidiLink.postMessage(mergedTrack[pos++].webMidiLink, '*');\n      } while (pos < length && mergedTrack[pos].time === time);\n\n      if (pos < length) {\n        procTime = window.performance.now() - procTime;\n        player.timer = player.window.setTimeout(\n          update,\n          (player.tempo / (1000 * timeDivision)) *\n            (mergedTrack[pos].time - time - procTime) *\n            (1 / player.tempoRate)\n        );\n      } else {\n        // loop\n        player.pause = true;\n        if (\n          player.enableCC111Loop &&\n          mark[0] &&\n          typeof mark[0].pos === 'number'\n        ) {\n          // ループ\n          pos = mark[0].pos;\n        } else if (player.enableLoop) {\n          player.initSequence();\n          player.playSequence();\n        }\n      }\n\n      player.position = pos;\n      player.time = time;\n\n      if (this.timeTotal === time) {\n        // 最後まで演奏した\n        this.onSequenceEnd();\n        return 2;\n      }\n    };\n\n    if (!this.pause) {\n      this.timer = player.window.setTimeout(\n        update,\n        (this.tempo / 1000) * timeDivision * this.track[0].time\n      );\n    } else {\n      // resume\n      this.timer = player.window.setTimeout(update, this.resume);\n      this.pause = false;\n      this.resume = -1;\n    }\n  }\n\n  /**\n   * MIDIファイルをロード\n   * @param {ArrayBuffer} buffer\n   */\n  loadMidiFile(buffer) {\n    /** @type {SMF} */\n    const parser = new SMF(buffer);\n\n    this.init();\n    parser.parse();\n\n    this.mergeMidiTracks(parser);\n  }\n\n  /**\n   * MLD形式（着メロ）のファイルをロード\n   * @param {ArrayBuffer} buffer\n   */\n  loadMldFile(buffer) {\n    /** @type {Mld} */\n    const parser = new Mld(buffer);\n\n    this.init();\n    parser.parse();\n\n    this.mergeMidiTracks(parser.convertToMidiTracks());\n  }\n\n  /**\n   * MapleStory2のMMLをロード\n   * @param {ArrayBuffer} buffer\n   */\n  loadMs2MmlFile(buffer) {\n    /** @type {MapleStory2Mml} */\n    const parser = new MapleStory2Mml(buffer);\n\n    this.init();\n    parser.parse();\n\n    this.mergeMidiTracks(parser);\n  }\n\n  /**\n   * まきまびしーく形式のMMLをロード\n   * @param {ArrayBuffer} buffer\n   */\n  loadMakiMabiSequenceFile(buffer) {\n    /** @type {MakiMabiSequence} */\n    const parser = new MakiMabiSequence(buffer);\n\n    this.init();\n    parser.parse();\n\n    this.mergeMidiTracks(parser);\n  }\n\n  /**\n   * Three Macro Language Editor形式のMMLファイルをロード\n   * @param {ArrayBuffer} buffer\n   */\n  load3MleFile(buffer) {\n    /** @type {ThreeMacroLanguageEditor} */\n    const parser = new ThreeMacroLanguageEditor(buffer);\n\n    this.init();\n    parser.parse();\n\n    this.mergeMidiTracks(parser);\n  }\n\n  /**\n   * まびっこ形式のファイルをロード\n   * @param {ArrayBuffer} buffer\n   */\n  loadMabiIccoFile(buffer) {\n    /** @type {MabiIcco} */\n    const parser = new MabiIcco(buffer);\n\n    this.init();\n    parser.parse();\n\n    this.mergeMidiTracks(parser);\n  }\n\n  /**\n   * @param {Object} midi\n   */\n  mergeMidiTracks(midi) {\n    /** @type {Array.<Object>} */\n    const mergedTrack = (this.track = []);\n    /** @type {Array.<Array.<Object>>} */\n    const tracks = midi.tracks;\n    /** @type {Array.<number>} */\n    const trackPosition = new Array(tracks.length);\n    /** @type {Array.<Array.<Array.<number>>>} */\n    const plainTracks = midi.plainTracks;\n    /** @type {Array.<Object>} */\n    let track;\n    /** @type {number} */\n    let i;\n    /** @type {number} */\n    let il;\n    /** @type {number} */\n    let j;\n    /** @type {number} */\n    let jl;\n\n    // initialize\n    for (i = 0, il = tracks.length; i < il; ++i) {\n      trackPosition[i] = 0;\n    }\n\n    // merge\n    for (i = 0, il = tracks.length; i < il; ++i) {\n      track = tracks[i];\n      for (j = 0, jl = track.length; j < jl; ++j) {\n        if (midi.formatType === 0 || i === 0) {\n          // 著作権情報と曲名を取得\n          // SMF1のときは先頭のトラックから情報を取得する。\n          if (track[j].subtype === 'SequenceTrackName') {\n            this.sequenceName = track[j].data[0];\n          } else if (track[j].subtype === 'CopyrightNotice') {\n            this.copyright = track[j].data[0];\n          }\n        }\n\n        mergedTrack.push({\n          track: i,\n          eventId: j,\n          time: track[j].time,\n          event: track[j],\n          webMidiLink:\n            'midi,' +\n            Array.prototype.map\n              .call(plainTracks[i][j], (a) => {\n                return a.toString(16);\n              })\n              .join(','),\n        });\n      }\n    }\n\n    // sort\n    mergedTrack.sort((a, b) => {\n      return a.time > b.time\n        ? 1\n        : a.time < b.time\n        ? -1\n        : a.track > b.track\n        ? 1\n        : a.track < b.track\n        ? -1\n        : a.eventId > b.eventId\n        ? 1\n        : a.eventId < b.eventId\n        ? -1\n        : 0;\n    });\n\n    // トータルの演奏時間\n    this.timeTotal = mergedTrack.slice(-1)[0].time;\n    this.sequence = midi;\n  }\n\n  /**\n   * @return {?string}\n   */\n  getSequenceName() {\n    return this.sequenceName;\n  }\n\n  /**\n   * @return {?string}\n   */\n  getCopyright() {\n    return this.copyright;\n  }\n\n  /**\n   * @return {?string}\n   */\n  getLyrics() {\n    return this.lyrics;\n  }\n\n  /**\n   * @return {?string}\n   */\n  getTextEvent() {\n    return this.textEvent;\n  }\n\n  /**\n   * @return {number}\n   */\n  getPosition() {\n    return this.position;\n  }\n\n  /**\n   * @param {number} pos\n   */\n  setPosition(pos) {\n    this.position = pos;\n  }\n\n  /**\n   * @return {number}\n   */\n  getLength() {\n    return this.length;\n  }\n\n  /**\n   * GMリセットを送信\n   */\n  sendGmReset() {\n    if (this.webMidiLink) {\n      // F0 7E 7F 09 01 F7\n      this.webMidiLink.contentWindow.postMessage('midi,F0,7E,7F,09,01,F7', '*');\n    }\n  }\n\n  /**\n   */\n  sendAllSoundOff() {\n    if (this.webMidiLink) {\n      this.webMidiLink.contentWindow.postMessage('midi,b0,78,0', '*');\n    }\n  }\n\n  /**\n   * 現在のテンポ\n   * @return {number}\n   */\n  getTempo() {\n    return Math.floor(60 / (this.tempo / 1000000));\n  }\n\n  tick2time(tick) {\n    // １拍あたりの秒（T120 = 0.5s）\n    const s = this.tempo / 1000000;\n    // 1Tickあたりの秒\n    const div = s / this.sequence.timeDivision;\n    // トータル秒\n    const seconds = (tick * div) | 0;\n    // 分\n    const divisorForMinutes = seconds % 3600;\n    // 秒\n    const divisorForSeconds = divisorForMinutes % 60;\n\n    return (\n      // 時間\n      Math.floor(seconds / 3600) +\n      ':' +\n      // 分\n      Math.floor(divisorForMinutes / 60)\n        .toString()\n        .padStart(2, '0') +\n      ':' +\n      // 秒\n      Math.ceil(divisorForSeconds).toString().padStart(2, '0')\n    );\n  }\n  /**\n   * 現在の時間\n   * @return {string}\n   */\n  getTime() {\n    return this.tick2time(this.time);\n  }\n  /**\n   * 演奏時間\n   * @return {string}\n   */\n  getTotalTime() {\n    return this.tick2time(this.timeTotal);\n  }\n}\n"],"names":["PSGConverter","MetaEvent","ChannelEvent","SystemExclusiveEvent","MakiMabiSequence","ThreeMacroLanguageEditor","input","optParams","parseHeader","parseTracks","toPlainTrack","header","Settings","encoder","TextEncoder","Encoding","title","Title","author","Source","timeDivision","TimeBase","headerTrack","push","Memo","TimeSignatureNN","TimeSignatureDD","tracks","endTimes","mmls","settings","block","Object","prototype","hasOwnProperty","call","match","RegExp","$1","keys","join","replace","name","Name","instrument","Patch","panpot","Pan","data","no","mml","part","ch","track","mml2Midi","channel","timeOffset","concat","events","endTime","Math","max","numberOfTracks","length","PATTERN","NOTE_TABLE","c","d","e","f","g","a","b","MINIM","SEMIBREVE","VELOCITY_MAGNIFICATION","plainEvents","noteOffNegativeOffset","ignoreTempo","igonreTempo","maxOctave","minOctave","octaveMode","minNote","maxNote","parse","toLowerCase","console","warn","time","currentSoundLength","currentNote","currentVelocity","currentOctave","tieEnabled","message","tick","command","value","$2","$4","floor","$3","note","$5","Meta","version","date","Event","subtype","deltaTime","optParameter1","optParameter2","parameter1","parameter2","Mld","ip","index","dataInformation","parseDataInformation","signature","String","fromCharCode","Error","fileLength","trackOffset","dataMajorType","dataMinorType","copy","exst","prot","sorc","titl","trac","vers","type","size","apply","subarray","limit","status","extendStatus","i","il","parseEditInstrument","result","info","modulator","ML","VIV","EG","SUS","RR","DR","AR","SL","TL","WF","FB","carrier","octaveSelect","parseVibrato","parseDeviceSpecific","key","octaveShift","subType","velocity","voice","drum","toString","timeBase","NaN","pow","tempo","id","count","point","volume","valance","depth","plainTracks","mfiTracks","mfiTrack","mfiEvent","prevEvent","tmpTrack","pos","tmp","str","j","jl","channelTime","sort","applyOctaveShift","deltaTimeToByteArray","split","map","charCodeAt","toSMF","table","TimeDivision","trackHeader","trackData","stringToArray","array","Array","unshift","Uint8Array","MabiIcco","Uint16Array","multipleKeys","ret","trackNo","line","trim","includes","mmiTempo","timeSig","current","program","songProgram","chord","currentCh","igonoreTempo","Ini","string","infomation","auther","mmsInstTable","rythmNum","rythmBase","currentPart","ch0_mml","ch1_mml","ch2_mml","Number","rawTrackEvents","rawEvents","event","raw","encode","MapleStory2Mml","parser","DOMParser","doc","parseFromString","querySelectorAll","textContent","Riff","chunkList","offset","padding","bigEndian","parseChunk","RiffChunk","chunk","SMF","chunkIndex","riffParser_","formatType","build","parseHeaderChunk","parseTrackChunk","getChunk","eventType","prevEventType","prevChannel","totalTime","plainBytes","readNumber","eventQueue","plainQueue","Player","target","webMidiLink","resume","pause","ready","position","timer","sequence","enableCC111Loop","enableFalcomLoop","enableMFiLoop","enableLoop","tempoRate","masterVolume","textEvent","sequenceName","copyright","lyrics","timeTotal","loaded","window","document","querySelector","enable","performance","now","contentWindow","postMessage","stop","initSequence","text","clearTimeout","player","sendInitMessage","addEventListener","ev","playSequence","style","height","body","scrollHeight","log","win","sendGmReset","port","process","msg","setMasterVolume","round","parentNode","removeChild","firstChild","iframe","createElement","src","className","appendChild","resizeHeight","setTimeout","substr","mergedTrack","mark","update","procTime","onSequenceEnd","buffer","init","mergeMidiTracks","convertToMidiTracks","midi","trackPosition","eventId","slice","s","div","seconds","divisorForMinutes","divisorForSeconds","padStart","ceil","tick2time"],"sourceRoot":""}